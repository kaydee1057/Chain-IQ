<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chain-IQ â€“ Next-Gen Crypto Wallet</title>

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" />
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'binance-yellow': '#F0B90B',
                    },
                },
            },
        }
    </script>
    <!-- QR Code Library -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode-generator/qrcode.js"></script>
    <!-- Flatpickr Date Picker -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <!-- API Integration -->
    <script src="/api-integration.js"></script>
    <script src="/frontend-integration.js"></script>
    <script src="/frontend/crypto-integration.js"></script>
    
    <style id="dynamic-styles">
        :root{
            --bg-dark:#0a0a0f;
            --bg-dark-gray:#121218;
            --bg-gray:#1e1e26;
            --border:#2a2a34;
            --text-primary:#f0f0f5;
            --text-secondary:#a0a0b0;
            --text-tertiary:#6a6a7a;
            --accent-green:#20e6a0;
            --accent-red:#ff5a5a;
            --accent-yellow:#ffd75a;
            --accent-blue:#5a8cff;
            --highlight:rgba(90,140,255,.1);
            --chip-gold:#FFD700;
            --chip-light:#FFEA92;
            --chip-dark:#B8860B;
            --font-color-primary: var(--text-primary);
            --button-color: var(--accent-blue);
            --card-color: var(--bg-dark-gray);
        }
    </style>
    <style>
        *{box-sizing:border-box;margin:0;padding:0}
        html,body{height:100%}
        body{
            font-family:'Inter',sans-serif;
            background:linear-gradient(145deg, var(--bg-dark) 0%, var(--bg-dark-gray) 100%);
            color:var(--font-color-primary);
            -webkit-font-smoothing:antialiased;
            line-height:1.5;
            overflow-x:hidden;
        }
        .hidden { display: none !important; }

        /* Styles for the dashboard layout */
        #dashboard-container {
            display: flex;
            width: 100%;
            height: 100vh;
        }

        /* Landing Page Specific Styles */
        .bg-binance-yellow{background:#F0B90B}
        .text-binance-yellow{color:#F0B90B}
        @keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-4px)}}
        .float{animation:float 5s ease-in-out infinite}
        .fade-in{opacity:0;transform:translateY(20px);transition:opacity 1s ease,transform 1s ease}
        .fade-in.is-visible{opacity:1;transform:none}
        .glass{background:rgba(25,25,25,.35);backdrop-filter:blur(20px)}


        /* ---------------------------------------------------- */
        /* SIDEBAR (Responsive)                                 */
        /* ---------------------------------------------------- */
        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            bottom: 0;
            width: 280px;
            background: linear-gradient(180deg, var(--bg-dark-gray) 0%, var(--bg-dark) 100%);
            border-right: 1px solid var(--border);
            z-index: 100;
            display: flex;
            flex-direction: column;
            transform: translateX(-100%);
            transition: transform 0.3s ease;
        }

        .sidebar.active {
            transform: translateX(0);
        }

        @media (min-width: 1025px) {
            .sidebar {
                position: static;
                transform: translateX(0);
                flex-shrink: 0;
                width: 280px;
                display: flex;
            }
        }

        /* Sidebar internals */
        .sidebar-header{
            padding:20px 16px;
            border-bottom:1px solid var(--border);
            display:flex;
            align-items:center;
            justify-content:space-between;
        }
        .logo-container{display:flex;align-items:center;gap:10px}
        .logo-img{width:32px;height:32px;border-radius:8px;object-fit:cover; background-color: var(--accent-yellow); color: var(--bg-dark); display: flex; align-items: center; justify-content: center; font-weight: bold;}
        .logo-text{font-weight:700;font-size:18px;color:var(--accent-yellow);white-space:nowrap}
        .sidebar-content{flex:1;overflow-y:auto;padding:16px}
        .account-card{
            background:var(--card-color);
            border:1px solid var(--border);
            border-radius:12px;
            padding:16px;
            margin-bottom:24px;
            transition:border-color .2s;
        }
        .account-card:hover{border-color:var(--accent-blue)}
        .-z-1 { z-index: -1; }
        .account-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
        .account-title{font-size:13px;color:var(--text-secondary);font-weight:600;letter-spacing:.5px}
        .account-actions{display:flex;gap:6px}
        .account-action{background:none;border:none;color:var(--text-tertiary);cursor:pointer;padding:4px;border-radius:4px;transition:color .2s}
        .account-action:hover{color:var(--accent-yellow)}
        .balance-item{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;font-size:13px}
        .balance-label{display:flex;align-items:center;gap:8px}
        .balance-value{font-weight:600;color:var(--text-primary)}
        .wallet-button{
            width:100%;
            margin-top:12px;
            padding:10px;
            border:1px solid var(--border);
            border-radius:8px;
            background:var(--bg-dark-gray);
            color:var(--text-primary);
            display:flex;
            align-items:center;
            justify-content:center;
            gap:8px;
            font-size:13px;
            cursor:pointer;
            transition:all .2s;
        }
        .wallet-button:hover{
            border-color:var(--accent-yellow);
            color:var(--accent-yellow);
            background:var(--highlight);
        }
        .menu-section{margin-bottom:24px}
        .menu-title{
            font-size:11px;
            font-weight:700;
            letter-spacing:.5px;
            text-transform:uppercase;
            color:var(--text-tertiary);
            padding:8px 12px;
            margin-bottom:4px;
        }
        .menu-list{list-style:none}
        .menu-item{margin-bottom:2px}
        .menu-link{
            display:flex;
            align-items:center;
            gap:12px;
            padding:10px 14px;
            border-radius:8px;
            text-decoration:none;
            color:var(--text-secondary);
            font-size:14px;
            transition:all .2s;
            position:relative;
        }
        .menu-link:hover{background:var(--highlight);color:var(--accent-yellow)}
        .menu-link.active{
            background:linear-gradient(90deg, var(--highlight), transparent);
            color:var(--accent-yellow);
            font-weight:600;
        }
        .menu-link.active::before{
            content:'';
            position:absolute;
            left:0;
            top:0;
            bottom:0;
            width:3px;
            background:var(--accent-yellow);
            border-radius:0 2px 2px 0;
        }
        .menu-icon{width:16px;height:16px}
        .logout-section{
            padding:16px;
            border-top:1px solid var(--border);
        }
        .logout-link{
            display:flex;
            align-items:center;
            gap:12px;
            padding:10px 14px;
            border-radius:8px;
            color:var(--accent-red);
            font-size:14px;
            text-decoration:none;
            transition:background .2s;
        }
        .logout-link:hover{background:rgba(255,90,90,.1)}

        /* ---------------------------------------------------- */
        /* MAIN LAYOUT (Flexbox)                                */
        /* ---------------------------------------------------- */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        /* Overlay for mobile sidebar */
        .sidebar-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.5);
            z-index: 99;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s;
        }
        .sidebar-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        /* Header */
        .header{
            background:linear-gradient(90deg,var(--bg-dark-gray),var(--bg-dark));
            border-bottom:1px solid var(--border);
            height:64px;
            padding:0 24px;
            display:flex;
            align-items:center;
            justify-content:space-between;
            position:sticky;
            top:0;
            z-index:50;
            backdrop-filter:blur(8px);
        }

        .header-left,.header-right{display:flex;align-items:center;gap:16px}
        .page-title{font-size:20px;font-weight:700}
        .page-subtitle{font-size:13px;color:var(--text-tertiary)}
        .mobile-nav-toggle{
            display:flex;
            align-items:center;
            justify-content:center;
            width:36px;
            height:36px;
            border:1px solid var(--border);
            border-radius:8px;
            background:var(--bg-gray);
            color:var(--text-secondary);
            font-size:18px;
            cursor:pointer;
            transition:all .2s;
        }
        .mobile-nav-toggle:hover{
            color:var(--accent-yellow);
            border-color:var(--accent-yellow);
            background:var(--highlight);
        }
        @media (min-width:1025px){
            .mobile-nav-toggle{display:none}
        }
        .header-button,
        .header-icon,
        .user-menu{
            display:flex;
            align-items:center;
            gap:6px;
            padding:8px 12px;
            border:1px solid var(--border);
            border-radius:8px;
            background:var(--bg-gray);
            color:var(--text-secondary);
            font-size:13px;
            cursor:pointer;
            transition:all .2s;
        }
        .header-button:hover,
        .header-icon:hover,
        .user-menu:hover{
            background:var(--highlight);
            color:var(--accent-yellow);
            border-color:var(--accent-yellow);
        }
        .user-avatar{
            width:32px;
            height:32px;
            border-radius:50%;
            background:var(--accent-yellow);
            color:#000;
            font-weight:700;
            display:flex;align-items:center;justify-content:center;
        }
        .notification-badge{
            position:absolute;
            top:-3px;right:-3px;
            width:16px;height:16px;
            background:var(--accent-red);
            color:#fff;
            font-size:10px;
            font-weight:700;
            border-radius:50%;
            display:flex;align-items:center;justify-content:center;
        }
        .user-details{display:flex;flex-direction:column;line-height:1.2}
        .user-name{font-weight:600}
        .user-email{font-size:11px;color:var(--text-tertiary)}
        @media (max-width:768px){
            .header-right{gap:8px}
            .header-button,
            .user-details,
            .header-right .user-menu > i{display:none}
            .header-icon,
            .user-menu{padding:6px}
        }

        /* User & Notification Dropdown Menu */
        .user-dropdown {
            position: absolute;
            top: calc(100% + 10px);
            right: 0;
            min-width: 220px;
            background: var(--bg-dark-gray);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 8px 0;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            opacity: 1;
            z-index: 1000;
            transform-origin: top right;
            transition: all 0.2s ease-in-out;
        }
        .user-dropdown.hidden {
            opacity: 0;
            transform: scale(0.95);
            pointer-events: none;
        }
        .user-dropdown a {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 16px;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 14px;
            transition: all 0.2s;
        }
        .user-dropdown a:hover {
            background: var(--highlight);
            color: var(--accent-yellow);
        }
        .user-dropdown .dropdown-divider {
            height: 1px;
            background: var(--border);
            margin: 8px 0;
        }
        .notification-dropdown {
            width: 360px;
            padding: 0;
        }
        #header-notification-list {
            max-height: 350px;
            overflow-y: auto;
        }


        /* Scrollable content wrapper */
        .scrollable-content{
            flex:1;
            overflow-y:auto;
        }

        /* ---------------------------------------------------- */
        /* CONTENT PAGES                                        */
        /* ---------------------------------------------------- */
        .page-content {
            display: none;
        }
        .page-content.active {
            display: block;
        }
        .app-container{
            max-width:1200px;
            margin:0 auto;
            padding:24px;
        }

        /* ---------------------------------------------------- */
        /* DASHBOARD GRID                                          */
        /* ---------------------------------------------------- */
        .content-grid{
            display:grid;
            grid-template-columns:1fr;
            gap:24px;
            margin-bottom:30px;
        }
        @media (min-width:1024px){
            .content-grid{grid-template-columns:1.2fr 0.8fr}
        }

        /* Balances Section - REDESIGNED */
        .balance-card-new {
            background: linear-gradient(135deg, var(--card-color), #0e0e12);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 24px;
            display: flex;
            flex-direction: column;
            gap: 24px;
            transition: border-color .2s;
        }
        .balance-card-new:hover { border-color: var(--accent-blue); }
        .balance-card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid var(--border);
            padding-bottom: 16px;
        }
        .balance-card-title {
            font-size: 1.25rem;
            font-weight: 700;
        }
        .balance-card-value {
            font-size: clamp(2rem, 4vw, 3rem);
            font-weight: 800;
        }
        .balance-card-change {
            font-size: 14px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .balance-breakdown {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }
        .balance-breakdown-item {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        .breakdown-label {
            font-size: 13px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .breakdown-value {
            font-size: 18px;
            font-weight: 700;
        }
        .balance-actions-new {
            display: flex;
            gap: 16px;
            width: 100%;
        }

        /* UPDATED BUTTON STYLES */
        .btn-action{
            padding: 12px 24px;
            border:none;
            border-radius:12px;
            flex: 1;
            font-weight:600;
            font-size: 1rem;
            cursor:pointer;
            transition:all .2s ease-in-out;
            box-shadow: 0 2px 6px rgba(0,0,0,.2);
            background: var(--button-color);
            color: #fff;
        }
        /* Special handling for buttons that need to be full width */
        .balance-actions-new .btn-action,
        .form-group .btn-action {
            flex: 1;
        }
        .btn-action:hover{
            transform:translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,.4);
        }
        .btn-deposit{
            background:linear-gradient(45deg, var(--button-color), #0056b3);
        }
        .btn-withdraw{
            background:linear-gradient(45deg, var(--accent-red), #b32a35);
        }
        .btn-convert{
            background:linear-gradient(45deg, #28a745, #1e7e34);
        }
        
        /* KYC Modal buttons */
        .kyc-prev, .kyc-next {
            flex: 0;
            padding: 8px 16px;
        }

        /* Cards Section */
        .cards-section{
            display:flex;
            flex-direction:column;
            background:linear-gradient(135deg,var(--card-color),#0e0e12);
            border:1px solid var(--border);
            border-radius:16px;
            padding:24px;
            transition:border-color .2s;
        }
        .cards-section:hover{border-color:var(--accent-yellow)}
        .card-stack{
            position:relative;
            width:100%;
            max-width:360px;
            margin-left:auto;
            margin-right:auto;
            height:220px;
            perspective:1000px;
            margin-bottom:24px;
        }
        .virtual-card{
            position:absolute;
            inset:0;
            border-radius:16px;
            padding:20px;
            color:#fff;
            transform-style:preserve-3d;
            transition:transform .6s cubic-bezier(.68,-.55,.27,1.55),box-shadow .3s, filter 0.3s;
            cursor:pointer;
            box-shadow:0 6px 20px rgba(0,0,0,.5);
            display:flex;
            flex-direction:column;
            justify-content:space-between;
        }
        .virtual-card.frozen {
            filter: grayscale(100%) brightness(0.7);
        }
        .virtual-card:hover{box-shadow:0 10px 30px rgba(0,0,0,.7)}
        .virtual-card.is-active{box-shadow:0 0 5px var(--accent-yellow);}
        .virtual-card-pattern{
            position:absolute;
            inset:0;
            opacity:.15;
            background-image:radial-gradient(circle at 2px 2px,#fff 1px,transparent 0);
            background-size:20px 20px;
            border-radius:16px;
        }
        .card-platinum{background:linear-gradient(135deg, #333, #111)}
        .card-gold{background:linear-gradient(135deg, #F0B90B, #FCD535); color: #181A20}
        .card-premium{background:linear-gradient(135deg, #1A237E, #5C6BC0)}
        .btn-request-card{
            width: 100%;
            max-width: 360px;
            padding: 10px 20px;
            border: none;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--accent-yellow), #f0b90b);
            color: #000;
            font-weight: 700;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s, opacity 0.2s;
            display: block;
            margin: 16px auto 0 auto;
        }
        .btn-request-card:hover{transform:translateY(-2px);box-shadow:0 6px 16px rgba(252,213,53,.4)}
        .btn-request-card:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        .card-chip {
            width: 40px;
            height: 30px;
        }

        /* ---------------------------------------------------- */
        /* TABLES                                                */
        /* ---------------------------------------------------- */
        .section-header{
            display:flex;
            align-items:center;
            gap:10px;
            font-size:18px;
            font-weight:700;
            margin:32px 0 18px;
        }
        .section-header i{color:var(--accent-blue)}
        .table-container{
            background:linear-gradient(135deg,var(--card-color),#0e0e12);
            border:1px solid var(--border);
            border-radius:16px;
            overflow:hidden;
            margin-bottom:24px;
            transition:border-color .2s;
        }
        .table-container:hover{border-color:var(--accent-blue)}
        .table-controls{
            display:flex;
            flex-direction:column;
            gap:16px;
            padding:16px;
        }
        @media (min-width:768px){
            .table-controls{flex-direction:row;justify-content:space-between;align-items:center}
        }
        .search-box{position:relative;width:100%}
        @media (min-width:768px){.search-box{width:300px}}
        .search-input{
            width:100%;
            padding:10px 16px 10px 40px;
            background:var(--bg-gray);
            border:1-solid var(--border);
            border-radius:8px;
            color:var(--text-primary);
            font-size:14px;
            outline:none;
            transition:border .2s;
        }
        .search-input:focus{border-color:var(--accent-blue)}
        .search-icon{
            position:absolute;
            left:12px;
            top:50%;
            transform:translateY(-50%);
            color:var(--text-tertiary);
            font-size:14px;
        }
        .table-tabs{
            display:flex;
            gap:6px;
            background:var(--bg-gray);
            padding:4px;
            border-radius:8px;
            width:fit-content;
        }
        .table-tab{
            padding:8px 14px;
            border-radius:6px;
            font-size:13px;
            font-weight:600;
            cursor:pointer;
            transition:all .2s;
            color:var(--text-secondary);
        }
        .table-tab.active{
            background:var(--bg-dark-gray);
            color:var(--text-primary);
            box-shadow:0 1px 3px rgba(0,0,0,.2);
        }

        /* Scrollable table */
        .scrollable-table-wrapper{
            max-height:480px;
            overflow-y:auto;
        }
        ::-webkit-scrollbar{width:6px}
        ::-webkit-scrollbar-track{background:var(--bg-dark-gray)}
        ::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px}
        ::-webkit-scrollbar-thumb:hover{background:var(--accent-blue)}

        /* Table styling */
        .crypto-table,.transaction-table{
            width:100%;
            border-collapse:collapse;
            table-layout:fixed;
        }
        thead th{
            background:var(--bg-gray);
            color:var(--text-secondary);
            padding:14px 12px;
            font-size:12px;
            font-weight:600;
            text-transform:uppercase;
            letter-spacing:.5px;
            position:sticky;
            top:0;
            z-index:10;
            border-bottom:1px solid var(--border);
        }
        tbody td{
            padding:14px 12px;
            font-size:13px;
            border-bottom:1px solid var(--border);
            white-space:nowrap;
            overflow:hidden;
            text-overflow:ellipsis;
        }
        tbody tr:hover{background:var(--highlight)}
        .asset{display:flex;align-items:center;gap:10px}
        .asset-icon{width:24px;height:24px;border-radius:50%;object-fit:cover}
        .asset-name{font-weight:600}
        .asset-ticker{font-size:12px;color:var(--text-tertiary)}
        .positive{color:var(--accent-green)}
        .negative{color:var(--accent-red)}
        .favorite-star{cursor:pointer;color:var(--text-tertiary);transition:color .2s}
        .favorite-star:hover{color:var(--accent-yellow)}
        .favorite-star.favorited{color:var(--accent-yellow)}
        .status-completed{color:var(--accent-green)}
        .status-pending{color:var(--accent-yellow)}
        .status-failed{color:var(--accent-red)}
        .status-blocked{color:var(--accent-red)}
        .status-frozen{color:var(--accent-yellow)}
        .status-reversed{color:var(--accent-blue)}

        /* Pagination */
        .pagination-controls{
            display:flex;
            justify-content:center;
            align-items:center;
            gap:6px;
            flex-wrap:wrap;
            padding:14px;
            border-top:1px solid var(--border);
            background:var(--bg-dark-gray);
        }
        .pagination-button{
            padding:6px 10px;
            border:1px solid var(--border);
            border-radius:6px;
            background:transparent;
            color:var(--text-secondary);
            font-size:13px;
            cursor:pointer;
            min-width:32px;
            display:flex;align-items:center;justify-content:center;
        }
        .pagination-button:hover:not(:disabled){
            background:var(--accent-blue);
            color:#fff;
            border-color:var(--accent-blue);
        }
        .pagination-button:disabled{opacity:.4;cursor:not-allowed}
        .pagination-button.active{
            background:var(--accent-blue);
            color:#fff;
            border-color:var(--accent-blue);
        }

        /* Modal specific styles */
        .modal {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 200;
            display: none;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .modal.active {
            display: flex;
            opacity: 1;
        }

        .modal-content {
            background: linear-gradient(145deg, var(--bg-dark-gray), #1e1e26);
            border: 1px solid var(--border);
            border-radius: 16px;
            width: 90%;
            max-width: 500px;
            padding: 32px;
            position: relative;
            transform: translateY(-20px);
            transition: transform 0.3s ease;
            overflow-y: auto;
            max-height: 90vh;
        }
        .modal.active .modal-content {
            transform: translateY(0);
        }
        .modal-content.modal-lg {
            max-width: 800px;
        }
        .modal-content.modal-xl {
            max-width: 1024px;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }
        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
        }
        .modal-close-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.5rem;
            cursor: pointer;
            transition: color 0.2s;
        }
        .modal-close-btn:hover {
            color: var(--accent-red);
        }
        .form-group {
            margin-bottom: 16px;
        }
        .form-label {
            display: block;
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }
        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 10px 14px;
            background: var(--bg-gray);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 14px;
            outline: none;
            transition: border-color 0.2s;
        }
        .form-input:focus, .form-select:focus, .form-textarea:focus {
            border-color: var(--accent-yellow);
        }
        .form-select {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="%23a0a0b0" viewBox="0 0 16 16"><path d="M8 11L3 6h10z"/></svg>');
            background-repeat: no-repeat;
            background-position: right 10px center;
        }
        .btn-submit-card {
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--accent-yellow), #f0b90b);
            color: #000;
            font-weight: 700;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin-top: 16px;
        }
        .btn-submit-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(252, 213, 53, 0.4);
        }
        .btn-secondary {
            background: var(--bg-gray);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }
        .btn-secondary:hover {
            border-color: var(--accent-yellow);
        }

        .form-row {
            display: flex;
            gap: 16px;
            margin-bottom: 16px;
        }
        .form-row > .form-group {
            flex: 1;
            margin-bottom: 0;
        }
        @media (max-width: 640px) {
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            .form-row > .form-group {
                margin-bottom: 16px;
            }
        }
        .qr-code-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 16px 0;
            padding: 10px;
            background: #fff;
            border-radius: 8px;
            width: 148px;
            height: 148px;
            margin-left: auto;
            margin-right: auto;
        }
        
        /* Styles for Withdrawal Page */
        .withdraw-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }
        @media (min-width: 1024px) {
            .withdraw-grid {
                grid-template-columns: 2fr 1fr;
            }
        }
        .method-card {
            padding: 1rem;
            border-radius: 0.5rem;
            border: 2px solid var(--border);
            cursor: pointer;
            transition: all 0.15s ease-in-out;
        }
        .method-card.selected {
            border-color: var(--accent-yellow);
            background-color: var(--highlight);
        }
        .method-card:hover:not(.selected) {
            border-color: var(--accent-yellow);
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        .method-card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        .llm-advice-container {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 0.5rem;
            background-color: rgba(240, 185, 11, 0.1);
            border: 1px solid rgba(240, 185, 11, 0.3);
            color: var(--text-primary);
            font-size: 0.875rem;
            display: none;
            animation: fadeIn 0.3s ease-out;
        }
        .llm-advice-container.show { display: block; }
        .llm-advice-container.loading {
            text-align: center;
            font-style: italic;
            color: var(--text-secondary);
            animation: pulse 1.5s infinite ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes pulse {
            0% { opacity: 0.7; }
            50% { opacity: 1; }
            100% { opacity: 0.7; }
        }

        /* Styles for Cards Page */
        .dashboard-card{background:var(--card-color);border:1px solid var(--border);border-radius:.75rem;}
        .status-badge{display:inline-flex;align-items:center;padding:.25rem .625rem;border-radius:9999px;font-size:.75rem;font-weight:600;text-transform:capitalize;}
        .status-badge.active{background:rgba(14,203,129,.2);color:var(--accent-green);}
        .status-badge.pending{background:rgba(255,193,7,.2);color:#FFC107;}
        .status-badge.inactive{background:rgba(246,70,93,.2);color:var(--accent-red);}
        .status-badge.shipped{background:rgba(99,102,241,.2);color:#6366f1;}
        .status-badge.blocked{background:rgba(100,116,139,.2);color:#64748b;}
        .status-badge.virtual{background:rgba(234,236,239,.1);color:var(--text-primary);}
        .progress-step{display:flex;flex-direction:column;align-items:center;text-align:center;flex:1;}
        .progress-circle{width:3rem;height:3rem;border-radius:50%;display:flex;align-items:center;justify-content:center;border:2px solid var(--border);transition:.3s;}
        .progress-circle.active{border-color:var(--accent-yellow);background:rgba(240,185,11,.2);}
        .progress-line{flex:1;height:2px;background:var(--border);margin:0 .5rem;transition:.3s;}
        .card-type-option{padding:1rem;border:2px solid var(--border);border-radius:.5rem;cursor:pointer;transition:.2s;}
        .card-type-option.selected{border-color:var(--accent-yellow);background:rgba(240,185,11,.1);}
        .virtual-card-container{position:relative; width:100%; aspect-ratio:16/10; transform-style:preserve-3d; transition:transform .6s cubic-bezier(.68,-.55,.27,1.55),box-shadow .3s; cursor:pointer; border-radius:1rem;}
        .virtual-card-container.flipped { transform: rotateY(180deg); }
        .virtual-card-front,.virtual-card-back{position:absolute;width:100%;height:100%;inset:0;backface-visibility:hidden;border-radius:1rem;padding:1rem;display:flex;flex-direction:column;justify-content:space-between;}
        .virtual-card-front{transform:rotateY(0deg);}
        .virtual-card-back{transform:rotateY(180deg);}
        .mag-stripe{height:3rem;background:#25282e;width:100%;margin-top:1rem;}
        .signature-strip{height:2rem;background:#eaecef;width:70%;margin-left:auto;margin-right:auto;border-radius:.25rem;display:flex;align-items:center;justify-content:flex-end;padding-right:.5rem;color:#181a20;font-family:monospace;font-size:1rem;font-weight:600;}
   
        .notification-list { list-style: none; padding: 0; margin: 0; }
        .notification-item { padding: 12px 16px; border-bottom: 1px solid var(--border); display: flex; gap: 12px; align-items: flex-start; transition: background-color 0.2s; }
        .notification-item:hover { background-color: var(--highlight); }
        .notification-item:last-child { border-bottom: none; }
        .notification-icon { font-size: 16px; color: var(--accent-blue); margin-top: 4px; }
        .notification-content { flex: 1; }
        .notification-message { font-size: 14px; color: var(--text-primary); }
        .notification-time { font-size: 12px; color: var(--text-tertiary); }
        
        #notifications-list-container {
            max-height: 450px;
            overflow-y: auto;
        }

        .toggle-switch-container { display: flex; align-items: center; justify-content: space-between; width: 100%;}
        .toggle-switch { position: relative; display: inline-block; width: 50px; height: 26px; }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .toggle-slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: var(--border); transition: .2s; border-radius: 26px; }
        .toggle-slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 3px; bottom: 3px; background-color: var(--text-primary); transition: .2s; border-radius: 50%; }
        input:checked + .toggle-slider { background-color: var(--accent-yellow); }
        input:checked + .toggle-slider:before { transform: translateX(24px); }
        .online-badge {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 12px;
            color: var(--accent-green);
            margin-top: 4px;
        }
        .online-dot {
            width: 8px;
            height: 8px;
            background-color: var(--accent-green);
            border-radius: 50%;
        }
    </style>
</head>
<body>
    
    <!-- ------------- LANDING PAGE CONTAINER ------------- -->
    <div id="landing-page-container">
        <!-- Header -->
        <header class="py-6 px-4 md:px-8 sticky top-0 z-50 bg-[#0a0a0f]">
            <nav class="max-w-7xl mx-auto flex flex-wrap items-center justify-between">
                <!-- Logo -->
                <div class="flex items-center space-x-2">
                    <svg class="w-7 h-7 text-binance-yellow" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2L2 12l10 10 10-10L12 2zm0 3.5L16.5 12 12 18.5 7.5 12 12 5.5z"/></svg>
                    <span class="font-bold text-xl tracking-tight">Chain-IQ</span>
                </div>

                <!-- Right side navigation and buttons -->
                <div class="flex items-center gap-8">
                    <!-- Navigation links - always visible -->
                    <div class="flex items-center space-x-8">
                        <a href="#features" class="text-sm text-gray-300 hover:text-white transition">Features</a>
                        <a href="#showcase" class="text-sm text-gray-300 hover:text-white transition">App</a>
                        <a href="#cta" class="text-sm text-gray-300 hover:text-white transition">About</a>
                    </div>

                    <!-- Auth Buttons - Always visible -->
                    <div class="flex items-center space-x-4">
                        <button class="app-switch-btn text-sm text-gray-300 border border-gray-600 rounded-full px-4 py-1.5 hover:border-white transition">Log In</button>
                        <button class="app-switch-btn text-sm bg-binance-yellow text-black font-semibold rounded-full px-4 py-1.5 hover:bg-yellow-400 transition">Sign Up</button>
                    </div>
                </div>
            </nav>
        </header>

        <main class="max-w-7xl mx-auto px-4 space-y-32 md:space-y-40 py-20">

        <!-- Hero -->
        <section class="fade-in flex flex-col items-center text-center gap-10 md:gap-20 relative">
            <!-- Background SVG -->
            <div class="absolute inset-0 z-0 overflow-hidden flex items-center justify-center pointer-events-none">
                <svg class="w-full h-auto float opacity-5" viewBox="0 0 400 300" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path opacity="0.1" d="M0 150h400M200 0v300" stroke="#F0B90B" stroke-width="0.5"/>
                    <g stroke="#F0B90B" stroke-width="2">
                        <path d="M190 150l-20-30h40l-20 30z"/>
                        <circle cx="200" cy="150" r="15" fill="none"/>
                    </g>
                    <g opacity="0.6">
                        <circle cx="100" cy="100" r="4" fill="#F0B90B"/>
                        <line x1="100" y1="100" x2="198" y2="148" stroke="#F0B90B" stroke-width="1"/>
                        <circle cx="300" cy="120" r="4" fill="#F0B90B"/>
                        <line x1="300" y1="120" x2="202" y2="148" stroke="#F0B90B" stroke-width="1"/>
                        <circle cx="150" cy="220" r="4" fill="#F0B90B"/>
                        <line x1="150" y1="220" x2="198" y2="152" stroke="#F0B90B" stroke-width="1"/>
                        <circle cx="250" cy="200" r="4" fill="#F0B90B"/>
                        <line x1="250" y1="200" x2="202" y2="152" stroke="#F0B90B" stroke-width="1"/>
                    </g>
                    <path opacity="0.3" d="M50 250c50-100 150-50 200 0" stroke="#F0B90B" stroke-width="2"/>
                    <path opacity="0.3" d="M350 250c-50-100-150-50-200 0" stroke="#F0B90B" stroke-width="2"/>
                </svg>
            </div>
            <div class="max-w-xl mx-auto z-10">
                <h1 class="text-4xl md:text-6xl font-extrabold tracking-tighter leading-tight">
                    The next-gen<br>crypto wallet.<br>
                    <span class="bg-clip-text text-transparent bg-gradient-to-r from-binance-yellow to-yellow-400">Powered by insights.</span>
                </h1>
                <p class="text-gray-400 mt-4 md:text-lg">Real-time market analytics, DeFi tools, and seamless cross-chain swaps in one non-custodial wallet.</p>
                <button class="app-switch-btn mt-8 bg-binance-yellow text-black font-bold rounded-full px-8 py-3 hover:bg-yellow-400 transition transform hover:scale-105">
                    Create Wallet
                </button>
            </div>
        </section>

        <!-- iPhone Showcase -->
        <section id="showcase" class="fade-in">
            <div class="flex flex-col md:flex-row items-center gap-10 md:gap-20">
                <!-- Device -->
                <div class="relative w-[280px] h-[580px] mx-auto">
                    <div class="absolute inset-0 bg-gradient-to-b from-gray-800 to-black rounded-[55px] shadow-2xl"></div>
                    <div class="absolute inset-1 bg-black rounded-[50px] overflow-hidden p-5">
                        <div class="w-20 h-5 bg-black rounded-full mx-auto mb-6"></div>
                        <div class="glass rounded-2xl p-4">
                            <p class="text-xs text-gray-400">Total Portfolio</p>
                            <p class="text-3xl font-bold">$12,450.89 <span class="text-green-400 text-sm">+3.2%</span></p>
                            <div class="flex gap-2 mt-3">
                                <span class="bg-gray-800 text-xs px-2 py-1 rounded-full">BTC 45%</span>
                                <span class="bg-gray-800 text-xs px-2 py-1 rounded-full">ETH 28%</span>
                                <span class="bg-gray-800 text-xs px-2 py-1 rounded-full">SOL 15%</span>
                            </div>
                        </div>
                        <p class="text-sm text-gray-400 mt-6 mb-2">Recent Activity</p>
                        <div class="space-y-2">
                            <div class="flex items-center justify-between text-sm">
                                <span class="text-green-400">+0.12 ETH</span>
                                <span class="text-gray-500 text-xs">2 min ago</span>
                            </div>
                            <div class="flex items-center justify-between text-sm">
                                <span class="text-red-400">-120 USDT</span>
                                <span class="text-gray-500 text-xs">15 min ago</span>
                            </div>
                        </div>
                        <div class="mt-6 glass rounded-2xl p-3 flex items-center gap-3">
                            <img class="w-12 h-12 rounded-lg object-cover" src="data:image/svg+xml,%3Csvg fill='%23F0B90B' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M12 2L2 12l10 10 10-10L12 2zm0 14.5L7.5 12 12 7.5 16.5 12 12 16.5z'/%3E%3C/svg%3E" alt="NFT">
                            <div>
                                <p class="text-sm font-semibold">Azuki #4181</p>
                                <p class="text-xs text-gray-400">Floor 14.2 ETH</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Copy -->
                <div class="flex-1 md:pl-10">
                    <h2 class="text-3xl md:text-4xl font-bold">Trade, track & collect<br>in one tap.</h2>
                    <p class="text-gray-400 mt-3 max-w-md">Live prices, push alerts, cross-chain swaps and gas-free NFT listingsâ€”all from a single, beautiful home screen.</p>
                    <ul class="mt-6 space-y-3 text-sm">
                        <li class="flex items-center gap-3"><span class="text-binance-yellow">âœ“</span> Real-time multi-chain portfolio</li>
                        <li class="flex items-center gap-3"><span class="text-binance-yellow">âœ“</span> Instant swaps with best-price routing</li>
                        <li class="flex items-center gap-3"><span class="text-binance-yellow">âœ“</span> Push-price alerts & limit orders</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Feature Grid -->
        <section id="features" class="fade-in">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-12">Everything you need.<br>Nothing you don't.</h2>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                 <!-- Feature Cards -->
                <div class="glass rounded-3xl p-6">
                    <div class="w-12 h-12 bg-binance-yellow/20 rounded-xl flex items-center justify-center mb-4"><svg class="w-6 h-6 text-binance-yellow" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v-1m0 0v-1m0 1H9m3 0h3m-3 4v-1m0 0v-1m0 1H9m3 0h3m-3-8V7m0 0V6m0 1H9m3 0h3m-3-4v1m0 0v1m0-1H9m3 0h3"/></svg></div>
                    <h3 class="font-semibold text-lg mb-2">Bank-grade Security</h3>
                    <p class="text-sm text-gray-400">Encrypted keys never leave your device. Biometric lock & secure enclave on iOS & Android.</p>
                </div>
                <div class="glass rounded-3xl p-6">
                    <div class="w-12 h-12 bg-binance-yellow/20 rounded-xl flex items-center justify-center mb-4"><svg class="w-6 h-6 text-binance-yellow" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"/></svg></div>
                    <h3 class="font-semibold text-lg mb-2">Multi-Chain</h3>
                    <p class="text-sm text-gray-400">Ethereum, BNB Smart Chain, Polygon, Solana, Arbitrum & moreâ€”one seed phrase.</p>
                </div>
                <div class="glass rounded-3xl p-6">
                    <div class="w-12 h-12 bg-binance-yellow/20 rounded-xl flex items-center justify-center mb-4"><svg class="w-6 h-6 text-binance-yellow" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg></div>
                    <h3 class="font-semibold text-lg mb-2">Gas-Free NFTs</h3>
                    <p class="text-sm text-gray-400">List and bid on OpenSea & LooksRare without paying gasâ€”Chain-IQ covers it.</p>
                </div>
                <div class="glass rounded-3xl p-6">
                    <div class="w-12 h-12 bg-binance-yellow/20 rounded-xl flex items-center justify-center mb-4"><svg class="w-6 h-6 text-binance-yellow" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/></svg></div>
                    <h3 class="font-semibold text-lg mb-2">Live Analytics</h3>
                    <p class="text-sm text-gray-400">Realized & unrealized PnL, cost basis, staking yieldâ€” all auto-calculated.</p>
                </div>
                <div class="glass rounded-3xl p-6">
                    <div class="w-12 h-12 bg-binance-yellow/20 rounded-xl flex items-center justify-center mb-4"><svg class="w-6 h-6 text-binance-yellow" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"/></svg></div>
                    <h3 class="font-semibold text-lg mb-2">Cross-Device Sync</h3>
                    <p class="text-sm text-gray-400">Native apps for iOS, Android, Chrome & Safari. One scan to sync.</p>
                </div>
                <div class="glass rounded-3xl p-6">
                    <div class="w-12 h-12 bg-binance-yellow/20 rounded-xl flex items-center justify-center mb-4"><svg class="w-6 h-6 text-binance-yellow" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"/></svg></div>
                    <h3 class="font-semibold text-lg mb-2">DeFi Earn</h3>
                    <p class="text-sm text-gray-400">Auto-stake, yield farm & lend with one tap. Track rewards in real time.</p>
                </div>
            </div>
        </section>

        </main>

        <footer id="cta" class="bg-black text-white py-12 px-4 md:px-8">
            <div class="max-w-7xl mx-auto flex flex-col items-center text-center space-y-8">
                <div class="flex flex-col items-center space-y-2">
                    <div class="flex items-center space-x-2">
                        <svg class="w-7 h-7 text-binance-yellow" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2L2 12l10 10 10-10L12 2zm0 3.5L16.5 12 12 18.5 7.5 12 12 5.5z"/></svg>
                        <span class="font-bold text-xl tracking-tight">Chain-IQ</span>
                    </div>
                    <p class="text-xs text-gray-400 max-w-sm">The next-gen crypto wallet powered by real-time market insights.</p>
                </div>
                <div class="flex flex-wrap justify-center gap-x-8 gap-y-4 text-sm text-gray-400">
                    <a href="#features" class="hover:text-white transition">Features</a>
                    <a href="#showcase" class="hover:text-white transition">App</a>
                    <a href="#" class="hover:text-white transition">Blog</a>
                    <a href="#" class="hover:text-white transition">Press</a>
                    <a href="#" class="hover:text-white transition">Terms of Service</a>
                    <a href="#" class="hover:text-white transition">Privacy Policy</a>
                </div>
                <div class="flex space-x-4">
                    <a href="#" aria-label="Twitter" class="text-gray-400 hover:text-white transition"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.71v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"/></svg></a>
                    <a href="#" aria-label="LinkedIn" class="text-gray-400 hover:text-white transition"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z" clip-rule="evenodd"/></svg></a>
                    <a href="#" aria-label="GitHub" class="text-gray-400 hover:text-white transition"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.477 2 12c0 4.418 2.865 8.165 6.839 9.49.5.092.682-.217.682-.482 0-.237-.009-.868-.014-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.031-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.203 2.398.1 2.651.64.7 1.03 1.595 1.03 2.688 0 3.848-2.338 4.695-4.566 4.943.359.308.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.001 10.001 0 0022 12c0-5.523-4.477-10-10-10z" clip-rule="evenodd"/></svg></a>
                </div>
            </div>
            <div class="mt-8 text-center text-gray-500 text-xs">
                Â© 2025 Chain-IQ Technologies Inc. All Rights Reserved.
            </div>
        </footer>
    </div>

    <!-- ------------- DASHBOARD CONTAINER (Initially Hidden) ------------- -->
    <div id="dashboard-container" class="hidden">
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo-container">
                    <div id="logo-img" class="logo-img">CIQ</div>
                    <div>
                        <span id="logo-text" class="logo-text">Chain-IQ</span>
                        <div id="online-badge" class="online-badge hidden">
                            <div class="online-dot"></div>
                            <span>Online</span>
                        </div>
                    </div>
                </div>
                <button class="mobile-nav-toggle close-toggle" id="close-sidebar">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="sidebar-content">
                <div class="account-card">
                    <div class="account-header">
                        <span class="account-title">Account Balance</span>
                        <div class="account-actions">
                            <button class="account-action"><i class="fas fa-credit-card"></i></button>
                            <button class="account-action"><i class="fas fa-eye"></i></button>
                        </div>
                    </div>
                    <div class="balance-item">
                        <div class="balance-label">
                            <i class="fas fa-dollar-sign"></i>
                            <span>Fiat Balance</span>
                        </div>
                        <div class="balance-value" id="sidebar-fiat-balance">$0.00</div>
                    </div>
                    <div class="balance-item">
                        <div class="balance-label">
                            <i class="fas fa-coins"></i>
                            <span>Total Crypto Assets</span>
                        </div>
                        <div class="balance-value" id="sidebar-crypto-balance">$0.00</div>
                    </div>
                    <button class="wallet-button" id="wallet-button">
                        <i class="fas fa-wallet"></i>
                        <span>Wallet</span>
                    </button>
                </div>

                <div class="menu-section">
                    <h3 class="menu-title">Main Menu</h3>
                    <ul class="menu-list">
                        <li><a href="#" class="menu-link active" data-page="dashboard"><i class="fas fa-th-large menu-icon"></i><span class="menu-text">Dashboard</span></a></li>
                        <li><a href="#" class="menu-link" data-page="crypto-assets"><i class="fas fa-chart-pie menu-icon"></i><span class="menu-text">Crypto Assets</span></a></li>
                        <li><a href="#" class="menu-link" data-page="cards"><i class="fas fa-credit-card menu-icon"></i><span class="menu-text">Cards</span></a></li>
                        <li><a href="#" class="menu-link" data-page="withdrawals"><i class="fas fa-money-bill-wave menu-icon"></i><span class="menu-text">Withdrawals</span></a></li>
                        <li><a href="#" class="menu-link" data-page="transactions"><i class="fas fa-chart-line menu-icon"></i><span class="menu-text">Transaction History</span></a></li>
                    </ul>
                </div>
                
                <div class="menu-section">
                    <h3 class="menu-title">Account Settings</h3>
                    <ul class="menu-list">
                        <li><a href="#" class="menu-link" data-page="notifications"><i class="fas fa-bell menu-icon"></i><span class="menu-text">Notifications</span></a></li>
                        <li><a href="#" class="menu-link" data-page="settings"><i class="fas fa-cog menu-icon"></i><span class="menu-text">Settings</span></a></li>
                        <li><a href="#" class="menu-link" data-page="profile"><i class="fas fa-user menu-icon"></i><span class="menu-text">Profile</span></a></li>
                    </ul>
                </div>
            </div>

            <div class="logout-section">
                <a href="#" class="logout-link">
                    <i class="fas fa-sign-out-alt menu-icon"></i>
                    <span class="menu-text">Logout</span>
                </a>
            </div>
        </aside>

        <div class="sidebar-overlay" id="sidebar-overlay"></div>

        <main class="main-content">
            <header class="header" id="header">
                <div class="header-left">
                    <button class="mobile-nav-toggle open-toggle" id="mobile-nav-toggle">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div>
                        <h1 class="page-title" id="page-title">Dashboard</h1>
                        <p class="page-subtitle" id="page-subtitle">Overview of your account</p>
                    </div>
                </div>
                <div class="header-right">
                    <div class="header-icon" id="notification-bell" style="position:relative">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge" id="notification-badge">0</span>
                        <!-- Notification Dropdown -->
                        <div id="notification-dropdown" class="user-dropdown notification-dropdown hidden">
                            <div class="p-4 flex justify-between items-center border-b border-gray-700">
                                <h3 class="font-semibold text-base">Notifications</h3>
                                <button id="modal-mark-all-read-btn" class="text-xs text-accent-yellow hover:underline">Mark all as read</button>
                            </div>
                            <div id="header-notification-list">
                                <!-- JS will render notifications here -->
                            </div>
                            <a href="#" class="block text-center py-2 text-sm text-accent-yellow hover:bg-gray-700/50" id="view-all-notifications-link">View All Notifications</a>
                        </div>
                    </div>
                    <div class="user-menu" id="user-menu-button" style="position:relative">
                        <div class="user-avatar" id="header-avatar">JD</div>
                        <div class="user-details">
                           <span class="user-name" id="header-user-name">John Doe</span>
                           <span class="user-email" id="header-user-email">john.doe@email.com</span>
                        </div>
                        <i class="fas fa-chevron-down ml-2"></i>
                        <div id="user-dropdown" class="user-dropdown hidden">
                            <div class="p-4 border-b border-gray-700">
                                <div class="font-semibold" id="dropdown-user-name">John Doe</div>
                                <div class="text-sm text-gray-400" id="dropdown-user-email">john.doe@email.com</div>
                            </div>
                            <a href="#" class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700" data-page="profile">Profile</a>
                            <a href="#" class="block px-4 py-2 text-sm text-gray-300 hover:bg-gray-700" data-page="settings">Settings</a>
                            <a href="#" id="logout-button-dropdown" class="block px-4 py-2 text-sm text-red-400 hover:bg-gray-700">Logout</a>
                        </div>
                    </div>
                </div>
            </header>

            <div class="scrollable-content">
                <div class="app-container">
                    <div id="dashboard-page" class="page-content active">
                        <div class="content-grid">
                            <div class="balance-card-new">
                                <div class="balance-card-header">
                                    <div>
                                        <span class="text-xs text-slate-400 font-semibold uppercase tracking-wide">Total Account Balance</span>
                                        <div class="balance-card-value text-slate-50" id="total-balance-value" data-usd-value="0">$0.00</div>
                                    </div>
                                    <div class="balance-card-change positive">
                                        <i class="fas fa-arrow-up text-sm"></i>
                                        <span>+2.34% (24h)</span>
                                    </div>
                                </div>
                                <div class="balance-breakdown">
                                    <div class="balance-breakdown-item">
                                        <div class="breakdown-label"><i class="fas fa-coins text-accent-yellow"></i><span>Crypto Assets</span></div>
                                        <div class="breakdown-value text-accent-yellow" id="crypto-balance-value" data-usd-value="0">$0.00</div>
                                    </div>
                                    <div class="balance-breakdown-item">
                                        <div class="breakdown-label"><i class="fas fa-dollar-sign text-accent-green"></i><span>Fiat Balance</span></div>
                                        <div class="breakdown-value text-accent-green" id="fiat-balance-value" data-usd-value="0">$0.00</div>
                                    </div>
                                </div>
                                <div class="balance-actions-new">
                                    <button class="btn-action btn-deposit" id="deposit-btn"><i class="fas fa-arrow-down text-sm mr-2"></i>Deposit</button>
                                    <button class="btn-action btn-withdraw" id="withdraw-btn"><i class="fas fa-arrow-up text-sm mr-2"></i>Withdraw</button>
                                </div>
                            </div>
                            <div class="cards-section">
                                <div class="card-stack" id="cardStack"></div>
                                <button class="btn-request-card" id="card-actions-btn">Card Actions</button>
                            </div>
                        </div>
                        <div id="dashboard-crypto-table-container"></div>
                        <div id="dashboard-transaction-table-container"></div>
                    </div>
                    <div id="crypto-assets-page" class="page-content hidden">
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 my-6">
                            <div class="table-container p-6">
                                <h3 class="text-xl font-bold mb-4">Wallet Actions</h3>
                                <div class="balance-breakdown mb-4">
                                    <div class="balance-breakdown-item">
                                        <div class="breakdown-label"><i class="fas fa-coins text-accent-yellow"></i><span>Crypto Assets</span></div>
                                        <div class="breakdown-value text-accent-yellow" id="crypto-page-crypto-balance" data-usd-value="0">$0.00</div>
                                    </div>
                                    <div class="balance-breakdown-item">
                                        <div class="breakdown-label"><i class="fas fa-dollar-sign text-accent-green"></i><span>Fiat Balance</span></div>
                                        <div class="breakdown-value text-accent-green" id="crypto-page-fiat-balance" data-usd-value="0">$0.00</div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="crypto-page-asset-select" class="form-label">Select Asset for Details</label>
                                    <select id="crypto-page-asset-select" class="form-select"></select>
                                </div>
                                <div class="flex gap-4">
                                    <button class="btn-action btn-deposit" id="crypto-page-deposit-btn">Deposit</button>
                                    <button class="btn-action btn-withdraw" id="crypto-page-withdraw-btn">Withdraw</button>
                                </div>
                            </div>
                            <div class="table-container p-6">
                                 <h3 class="text-xl font-bold mb-4">Convert Assets</h3>
                                 <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-end">
                                    <div class="form-group mb-0">
                                        <label for="convert-from-asset" class="form-label">From</label>
                                        <select id="convert-from-asset" class="form-select"></select>
                                    </div>
                                     <div class="form-group mb-0">
                                        <label for="convert-to-asset" class="form-label">To</label>
                                        <select id="convert-to-asset" class="form-select"></select>
                                    </div>
                                 </div>
                                 <div class="form-group mt-4">
                                    <label for="convert-amount" class="form-label">Amount</label>
                                    <input type="number" id="convert-amount" class="form-input" placeholder="0.00">
                                 </div>
                                 <div id="conversion-result" class="text-center text-lg font-semibold my-2"></div>
                                 <button class="btn-action btn-convert w-full" id="convert-btn">Convert</button>
                            </div>
                        </div>
                        <div id="crypto-assets-page-table-container"></div>
                        <div id="crypto-assets-page-tx-table-container"></div>
                    </div>
                    <div id="cards-page" class="page-content hidden">
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                            <div class="dashboard-card p-4"><div class="text-sm text-text-secondary">Total Cards</div><div class="text-2xl font-bold" id="total-cards-page">0</div></div>
                            <div class="dashboard-card p-4"><div class="text-sm text-text-secondary">Active</div><div class="text-2xl font-bold text-green-400" id="active-cards-page">0</div></div>
                            <div class="dashboard-card p-4"><div class="text-sm text-text-secondary">Pending</div><div class="text-2xl font-bold text-yellow-400" id="pending-cards-page">0</div></div>
                            <div class="dashboard-card p-4"><div class="text-sm text-text-secondary">Inactive</div><div class="text-2xl font-bold text-red-400" id="inactive-cards-page">0</div></div>
                        </div>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-6">
                            <div class="cards-section">
                                 <div class="card-stack" id="cardStackPage"></div>
                                <div class="flex gap-4 mt-4">
                                    <button id="cards-page-deposit-btn" class="btn-action btn-deposit w-full">Details</button>
                                    <button id="cards-page-withdraw-btn" class="btn-action btn-withdraw w-full">Withdraw</button>
                                </div>
                            </div>
                            <div class="dashboard-card p-6 flex flex-col">
                                <h2 class="text-xl font-semibold mb-4">Card Management</h2>
                                <div class="grid grid-cols-2 gap-4">
                                    <button class="btn-secondary h-12 rounded-lg flex items-center justify-center gap-2" id="freezeCardBtn"><i class="fas fa-snowflake"></i><span>Freeze</span></button>
                                    <button class="btn-secondary h-12 rounded-lg flex items-center justify-center gap-2" id="showDetailsBtn"><i class="fas fa-eye"></i><span>Details</span></button>
                                    <button class="btn-secondary h-12 rounded-lg flex items-center justify-center gap-2" id="setPinBtn"><i class="fas fa-key"></i><span>Set PIN</span></button>
                                    <button class="btn-secondary h-12 rounded-lg flex items-center justify-center gap-2" id="viewLimitsBtn"><i class="fas fa-tachometer-alt"></i><span>Limits</span></button>
                                </div>
                                <button class="btn-request-card w-full max-w-none mt-auto" id="requestNewBtn">Request New Card</button>
                            </div>
                        </div>
                        <div class="dashboard-card p-6">
                            <h2 class="text-xl font-semibold mb-4">All Cards (<span id="all-cards-count">0</span>)</h2>
                            <div id="all-cards-list" class="space-y-3 max-h-[420px] overflow-y-auto"></div>
                        </div>
                    </div>
                    <div id="withdrawals-page" class="page-content hidden">
                        <div class="withdraw-grid">
                            <div class="space-y-6">
                                <div class="table-container p-6">
                                    <h3 class="text-xl font-bold mb-4">Withdrawal Method</h3>
                                    <div class="method-card-grid">
                                        <div class="method-card" data-method="bank"><div class="flex items-center gap-3 mb-2"><i class="fas fa-university text-yellow-400 text-2xl"></i><span class="font-semibold">Bank Transfer</span></div><div class="text-sm text-gray-400 space-y-1"><div>Fee: $5.00</div><div>Time: 1-3 business days</div><div>Min: $100.00</div></div></div>
                                        <div class="method-card" data-method="card"><div class="flex items-center gap-3 mb-2"><i class="fas fa-credit-card text-yellow-400 text-2xl"></i><span class="font-semibold">Card Withdrawal</span></div><div class="text-sm text-gray-400 space-y-1"><div>Fee: 2.5%</div><div>Time: Instant</div><div>Min: $10.00</div></div></div>
                                        <div class="method-card" data-method="crypto"><div class="flex items-center gap-3 mb-2"><i class="fab fa-bitcoin text-yellow-400 text-2xl"></i><span class="font-semibold">Crypto Address</span></div><div class="text-sm text-gray-400 space-y-1"><div>Fee: Network fee</div><div>Time: 10-30 minutes</div><div>Min: $50.00</div></div></div>
                                    </div>
                                </div>
                                <div class="table-container p-6">
                                   <h3 class="text-xl font-bold mb-4 flex items-center gap-2"><i class="fas fa-shield-alt"></i> Security Verification</h3>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div class="p-4 rounded-lg bg-gray-800"><div class="flex items-center gap-2 mb-2 text-green-400"><i class="fas fa-check-circle"></i><span class="font-semibold">Company Security</span></div><div class="text-sm text-gray-400">Protected under financial regulations</div></div>
                                        <div class="p-4 rounded-lg bg-gray-800"><div class="flex items-center gap-2 mb-2 text-green-400"><i class="fas fa-check-circle"></i><span class="font-semibold">KYC Verification</span></div><div class="text-sm text-gray-400">KYC Verified</div></div>
                                    </div>
                                    <div class="text-sm text-gray-400 mt-4">All withdrawals are secured by our compliance protocols and require KYC verification.</div>
                                </div>
                            </div>
                            <div class="space-y-6">
                                <div class="table-container p-6">
                                    <h3 class="text-xl font-bold mb-4">Withdrawal Limits</h3>
                                    <div class="space-y-3">
                                        <div class="flex justify-between text-sm"><span class="text-gray-400">Fiat Limit</span><span id="fiat-limit">$2,000,000.00</span></div>
                                        <div class="flex justify-between text-sm"><span class="text-gray-400">Crypto Limit</span><span id="crypto-limit">100.00000000 BTC</span></div>
                                        <div class="flex justify-between text-sm"><span class="text-gray-400">Fiat Used</span><span class="text-yellow-400" id="fiat-used">$0.00</span></div>
                                        <div class="w-full bg-gray-700 rounded-full h-2"><div class="bg-yellow-400 h-2 rounded-full" id="fiat-progress-bar" style="width: 0%;"></div></div>
                                        <div class="text-xs text-gray-500" id="fiat-remaining">Remaining: $2,000,000.00</div>
                                    </div>
                                </div>
                                <div class="table-container p-6">
                                    <h3 class="text-xl font-bold mb-4">Available Balances</h3>
                                    <div class="space-y-3">
                                        <div class="flex justify-between items-center p-3 rounded-lg bg-gray-800"><div><div class="font-semibold">USD</div><div class="text-sm text-gray-400">Fiat Currency</div></div><div class="font-semibold" id="display-fiat-balance" data-usd-value="0">$0.00</div></div>
                                        <div class="flex justify-between items-center p-3 rounded-lg bg-gray-800"><div><div class="font-semibold">USD</div><div class="text-sm text-gray-400">Total Crypto Assets</div></div><div class="font-semibold" id="display-crypto-balance" data-usd-value="0">$0.00</div></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="withdrawals-page-tx-table-container" class="mt-6"></div>
                    </div>
                    <div id="transactions-page" class="page-content hidden">
                        <div class="table-container">
                            <div class="table-controls grid grid-cols-1 md:grid-cols-4 gap-4">
                                <select id="tx-filter-type" class="form-select"><option value="all">All Types</option><option value="Deposit">Deposit</option><option value="Withdrawal">Withdrawal</option><option value="Trade">Trade</option></select>
                                <select id="tx-filter-asset" class="form-select"><option value="all">All Assets</option></select>
                                <input type="text" id="tx-filter-date" class="form-input" placeholder="Select Date Range">
                                <button id="tx-filter-apply" class="btn-action">Apply Filters</button>
                            </div>
                        </div>
                        <div id="transactions-page-table-container"></div>
                    </div>

                    <!-- Notifications Page -->
                    <div id="notifications-page" class="page-content hidden">
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div class="table-container p-6">
                                <h3 class="text-xl font-bold mb-4">Notification Settings</h3>
                                <div class="space-y-4">
                                    <div class="p-4 bg-gray-800 rounded-lg"><div class="flex items-center justify-between"><div><div class="font-semibold">Security Alerts</div><div class="text-sm text-gray-400">Login attempts and security updates</div></div><label class="toggle-switch"><input type="checkbox" id="security-alerts-toggle" checked><span class="toggle-slider"></span></label></div></div>
                                    <div class="p-4 bg-gray-800 rounded-lg"><div class="flex items-center justify-between"><div><div class="font-semibold">Transaction Notifications</div><div class="text-sm text-gray-400">Deposits, withdrawals, and trades</div></div><label class="toggle-switch"><input type="checkbox" checked><span class="toggle-slider"></span></label></div></div>
                                    <div class="p-4 bg-gray-800 rounded-lg">
                                        <div class="flex items-center justify-between">
                                            <div>
                                                <div class="font-semibold">Price Alerts</div>
                                                <div class="text-sm text-gray-400">Cryptocurrency price movements</div>
                                            </div>
                                            <label class="toggle-switch">
                                                <input type="checkbox" id="price-alerts-toggle">
                                                <span class="toggle-slider"></span>
                                            </label>
                                        </div>
                                        <div id="price-alert-asset-selector" class="hidden mt-4">
                                            <label for="price-alert-asset" class="form-label">Select Asset for Alerts</label>
                                            <select id="price-alert-asset" class="form-select"></select>
                                        </div>
                                    </div>
                                    <div class="p-4 bg-gray-800 rounded-lg"><div class="flex items-center justify-between"><div><div class="font-semibold">Newsletter</div><div class="text-sm text-gray-400">Weekly updates and news</div></div><label class="toggle-switch"><input type="checkbox"><span class="toggle-slider"></span></label></div></div>
                                </div>
                            </div>
                            <div class="table-container p-6">
                                <h3 class="text-xl font-bold mb-4">Delivery Methods</h3>
                                <div class="space-y-4">
                                    <div class="p-4 bg-gray-800 rounded-lg"><div class="flex items-center justify-between"><div class="flex items-center gap-3"><i class="fas fa-envelope text-yellow-400"></i><div><div class="font-semibold">Email Notifications</div><div class="text-sm text-gray-400">j***@example.com</div></div></div><label class="toggle-switch"><input type="checkbox" checked><span class="toggle-slider"></span></label></div></div>
                                    <div class="p-4 bg-gray-800 rounded-lg"><div class="flex items-center justify-between"><div class="flex items-center gap-3"><i class="fas fa-mobile-alt text-yellow-400"></i><div><div class="font-semibold">Push Notifications</div><div class="text-sm text-gray-400">Mobile & Desktop</div></div></div><label class="toggle-switch"><input type="checkbox" checked><span class="toggle-slider"></span></label></div></div>
                                </div>
                            </div>
                        </div>
                        <div class="table-container p-6 mt-6">
                            <div class="flex items-center justify-between mb-4"><h3 class="text-xl font-bold">Recent Notifications</h3><button class="btn-action btn-secondary" id="mark-all-read-btn" style="padding: 8px 16px; font-size: 0.875rem; border-radius: 8px; flex: 0 0 auto;">Mark All as Read</button></div>
                            <div class="notification-list" id="notifications-list-container"></div>
                        </div>
                    </div>

                    <!-- Settings Page -->
                    <div id="settings-page" class="page-content hidden">
                        <div class="space-y-6">
                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                <div class="table-container p-6">
                                    <h3 class="text-xl font-bold mb-4">Account Settings</h3>
                                    <div class="space-y-4">
                                        <div class="p-4 bg-gray-800 rounded-lg"><div class="flex items-center justify-between"><div><div class="font-semibold">Time Zone</div><div class="text-sm text-gray-400">Set your local time zone</div></div><select class="form-select w-48" id="timezone-select"></select></div></div>
                                        <div class="p-4 bg-gray-800 rounded-lg"><div class="flex items-center justify-between"><div><div class="font-semibold">Currency Display</div><div class="text-sm text-gray-400">Default currency for display</div></div>
                                            <select class="form-select w-32" id="currency-select">
                                                <option value="USD">USD</option>
                                                <option value="EUR">EUR</option>
                                                <option value="GBP">GBP</option>
                                                <option value="CAD">CAD</option>
                                                <option value="AUD">AUD</option>
                                            </select>
                                        </div></div>
                                    </div>
                                </div>
                                <div class="table-container p-6">
                                    <h3 class="text-xl font-bold mb-4">Privacy Settings</h3>
                                    <div class="space-y-4">
                                        <div class="p-4 bg-gray-800 rounded-lg"><div class="flex items-center justify-between"><div><div class="font-semibold">Activity Status</div><div class="text-sm text-gray-400">Show when you're active</div></div><label class="toggle-switch"><input type="checkbox" id="activity-status-toggle" checked><span class="toggle-slider"></span></label></div></div>
                                        <div class="p-4 bg-gray-800 rounded-lg"><div class="flex items-center justify-between"><div><div class="font-semibold">Balance Display</div><div class="text-sm text-gray-400">Show balance on cards</div></div><label class="toggle-switch"><input type="checkbox" id="balance-display-toggle" checked><span class="toggle-slider"></span></label></div></div>
                                    </div>
                                </div>
                            </div>
                            <div class="table-container p-6">
                                <div class="flex items-center justify-between mb-6">
                                    <div>
                                        <h3 class="text-xl font-bold">Security Settings</h3>
                                        <p class="text-sm text-gray-400 mt-1">Manage your account security preferences</p>
                                    </div>
                                    <div class="w-10 h-10 bg-yellow-900/20 rounded-full flex items-center justify-center">
                                        <i class="fas fa-shield-alt text-accent-yellow text-xl"></i>
                                    </div>
                                </div>

                                <div class="grid gap-6 lg:grid-cols-2">
                                    <!-- Security Status Card -->
                                    <div class="p-4 bg-gray-800 rounded-lg">
                                        <div class="flex items-start gap-4">
                                            <div class="w-10 h-10 rounded-full bg-green-900/20 flex items-center justify-center">
                                                <i class="fas fa-check-circle text-accent-green text-xl"></i>
                                            </div>
                                            <div>
                                                <h4 class="font-semibold mb-1">Security Status</h4>
                                                <p class="text-sm text-gray-400">Your account is properly secured</p>
                                                <div class="flex items-center gap-4 mt-3">
                                                    <div class="flex items-center gap-2 text-xs text-gray-400">
                                                        <i class="fas fa-check-circle text-accent-green"></i>
                                                        2FA Enabled
                                                    </div>
                                                    <div class="flex items-center gap-2 text-xs text-gray-400">
                                                        <i class="fas fa-check-circle text-accent-green"></i>
                                                        Strong Password
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Last Password Change Card -->
                                    <div class="p-4 bg-gray-800 rounded-lg">
                                        <div class="flex items-start gap-4">
                                            <div class="w-10 h-10 rounded-full bg-blue-900/20 flex items-center justify-center">
                                                <i class="fas fa-clock text-accent-blue text-xl"></i>
                                            </div>
                                            <div>
                                                <h4 class="font-semibold mb-1">Last Password Change</h4>
                                                <p class="text-sm text-gray-400">30 days ago</p>
                                                <div class="text-xs text-gray-400 mt-3">
                                                    <i class="fas fa-info-circle"></i>
                                                    We recommend changing your password every 90 days
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Password Change Form -->
                                    <div class="lg:col-span-2 mt-2">
                                        <div class="bg-gray-800 rounded-lg p-6">
                                            <h4 class="font-semibold mb-4 flex items-center gap-2">
                                                <i class="fas fa-key text-accent-yellow"></i>
                                                Change Password
                                            </h4>
                                            <form id="change-password-form" class="space-y-4">
                                                <div class="grid gap-4 lg:grid-cols-2">
                                                    <div class="form-group">
                                                        <label for="current-password" class="form-label flex items-center gap-2">
                                                            <span>Current Password</span>
                                                            <i class="fas fa-circle-info text-gray-400 text-xs" title="Enter your current password"></i>
                                                        </label>
                                                        <div class="relative">
                                                            <input type="password" id="current-password" class="form-input pr-10" required>
                                                            <button type="button" class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-accent-yellow password-toggle" data-target="current-password">
                                                                <i class="fas fa-eye"></i>
                                                            </button>
                                                        </div>
                                                    </div>

                                                    <div class="form-group">
                                                        <label for="new-password" class="form-label flex items-center gap-2">
                                                            <span>New Password</span>
                                                            <i class="fas fa-circle-info text-gray-400 text-xs" title="Password must be at least 8 characters"></i>
                                                        </label>
                                                        <div class="relative">
                                                            <input type="password" id="new-password" class="form-input pr-10" required minlength="8">
                                                            <button type="button" class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-accent-yellow password-toggle" data-target="new-password">
                                                                <i class="fas fa-eye"></i>
                                                            </button>
                                                        </div>
                                                    </div>

                                                    <div class="form-group lg:col-span-2">
                                                        <label for="confirm-password" class="form-label">Confirm New Password</label>
                                                        <div class="relative">
                                                            <input type="password" id="confirm-password" class="form-input pr-10" required>
                                                            <button type="button" class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-accent-yellow password-toggle" data-target="confirm-password">
                                                                <i class="fas fa-eye"></i>
                                                            </button>
                                                        </div>

                                                        <div id="password-strength" class="hidden mt-4">
                                                            <div class="flex items-center justify-between mb-2">
                                                                <div class="text-sm font-semibold text-gray-400">Password Strength:</div>
                                                                <div id="strength-text" class="text-sm font-medium"></div>
                                                            </div>
                                                            <div class="h-2 bg-gray-700 rounded-full overflow-hidden mb-3">
                                                                <div id="strength-bar" class="h-full transition-all duration-300" style="width: 0%"></div>
                                                            </div>
                                                            <div class="grid grid-cols-2 gap-x-6 gap-y-2 text-sm text-gray-400">
                                                                <div class="flex items-center gap-2">
                                                                    <i class="fas fa-check-circle requirement-check"></i>
                                                                    8+ characters
                                                                </div>
                                                                <div class="flex items-center gap-2">
                                                                    <i class="fas fa-check-circle requirement-check"></i>
                                                                    Uppercase letter
                                                                </div>
                                                                <div class="flex items-center gap-2">
                                                                    <i class="fas fa-check-circle requirement-check"></i>
                                                                    Number
                                                                </div>
                                                                <div class="flex items-center gap-2">
                                                                    <i class="fas fa-check-circle requirement-check"></i>
                                                                    Special character
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="flex items-center gap-4 pt-4">
                                                    <button type="submit" class="btn-action">
                                                        <i class="fas fa-key mr-2"></i>
                                                        Update Password
                                                    </button>
                                                    <button type="button" class="btn-action btn-secondary" onclick="this.form.reset()">
                                                        Cancel
                                                    </button>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Profile Page -->
                    <div id="profile-page" class="page-content hidden">
                       <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                            <div class="table-container p-6 lg:col-span-full">
                                <div class="text-center mb-6">
                                    <div class="relative w-32 h-32 mx-auto mb-4">
                                        <div id="profile-avatar-container" class="w-full h-full bg-gray-800 rounded-full flex items-center justify-center">
                                            <span class="text-4xl font-bold" id="profile-avatar-initials">JD</span>
                                        </div>
                                        <button class="absolute bottom-0 right-0 w-10 h-10 bg-accent-yellow rounded-full flex items-center justify-center shadow-lg hover:bg-yellow-500 transition-colors">
                                            <i class="fas fa-camera text-black"></i>
                                        </button>
                                    </div>
                                    <h2 class="text-xl font-bold mb-1" id="profile-full-name">John Doe</h2>
                                    <p class="text-text-secondary mb-4">ID: #24891</p>
                                </div>
                                <div class="space-y-4">
                                    <div class="p-4 bg-gray-800 rounded-lg"><div class="flex items-center justify-between"><div><div class="text-sm text-text-secondary">Full Name</div><div class="font-semibold" id="profile-display-name">John Doe</div></div><button class="btn-action btn-secondary ml-auto" id="change-name-btn" style="padding: 8px 16px; font-size: 0.875rem; border-radius: 8px; flex: 0 0 auto;">Change</button></div></div>
                                    <div class="p-4 bg-gray-800 rounded-lg"><div class="flex items-center justify-between"><div><div class="text-sm text-text-secondary">Email Address</div><div class="font-semibold" id="profile-display-email">john.doe@example.com</div></div><button class="btn-action btn-secondary ml-auto" id="change-email-btn" style="padding: 8px 16px; font-size: 0.875rem; border-radius: 8px; flex: 0 0 auto;">Change</button></div></div>
                                    <div class="p-4 bg-gray-800 rounded-lg"><div class="flex items-center justify-between"><div><div class="text-sm text-text-secondary">KYC Status</div><div class="status-badge active inline-block mt-1">Verified</div></div><button id="start-kyc-btn" class="btn-action ml-auto" style="padding: 8px 16px; font-size: 0.875rem; border-radius: 8px; flex: 0 0 auto;">Update</button></div></div>
                                    <div class="p-4 bg-gray-800 rounded-lg"><div class="flex items-center justify-between"><div><div class="text-sm text-text-secondary">Member Since</div><div class="font-semibold">January 15, 2025</div></div><div class="text-sm text-accent-yellow">248 days</div></div></div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </main>
        
        <!-- All Modals for the Dashboard -->
        <div id="dashboard-modals">
            <div class="modal" id="request-card-modal">
                <div class="modal-content modal-lg">
                    <div class="modal-header">
                        <h2 class="modal-title">Request a New Card</h2>
                        <button class="modal-close-btn" data-modal-id="request-card-modal"><i class="fas fa-times"></i></button>
                    </div>
                    <form id="card-request-form">
                        <!-- Card Tier Selection -->
                        <div class="form-group">
                            <label class="form-label mb-2">Select Card Tier</label>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                                <div class="card-type-option rounded-lg p-4" data-tier="platinum">
                                    <div class="flex items-center justify-between mb-2">
                                        <h3 class="font-bold">Platinum</h3>
                                        <span class="text-accent-yellow">$500/year</span>
                                    </div>
                                    <ul class="text-sm text-gray-400 space-y-2">
                                        <li><i class="fas fa-check text-accent-yellow mr-2"></i>$50,000 monthly limit</li>
                                        <li><i class="fas fa-check text-accent-yellow mr-2"></i>5% cashback on crypto</li>
                                        <li><i class="fas fa-check text-accent-yellow mr-2"></i>Priority support</li>
                                        <li><i class="fas fa-check text-accent-yellow mr-2"></i>Airport lounge access</li>
                                    </ul>
                                </div>
                                <div class="card-type-option rounded-lg p-4" data-tier="gold">
                                    <div class="flex items-center justify-between mb-2">
                                        <h3 class="font-bold">Gold</h3>
                                        <span class="text-accent-yellow">$200/year</span>
                                    </div>
                                    <ul class="text-sm text-gray-400 space-y-2">
                                        <li><i class="fas fa-check text-accent-yellow mr-2"></i>$25,000 monthly limit</li>
                                        <li><i class="fas fa-check text-accent-yellow mr-2"></i>3% cashback on crypto</li>
                                        <li><i class="fas fa-check text-accent-yellow mr-2"></i>24/7 support</li>
                                        <li><i class="fas fa-check text-accent-yellow mr-2"></i>Travel insurance</li>
                                    </ul>
                                </div>
                                <div class="card-type-option rounded-lg p-4" data-tier="premium">
                                    <div class="flex items-center justify-between mb-2">
                                        <h3 class="font-bold">Premium</h3>
                                        <span class="text-accent-yellow">$50/year</span>
                                    </div>
                                    <ul class="text-sm text-gray-400 space-y-2">
                                        <li><i class="fas fa-check text-accent-yellow mr-2"></i>$10,000 monthly limit</li>
                                        <li><i class="fas fa-check text-accent-yellow mr-2"></i>1% cashback on crypto</li>
                                        <li><i class="fas fa-check text-accent-yellow mr-2"></i>Email support</li>
                                        <li><i class="fas fa-check text-accent-yellow mr-2"></i>Basic insurance</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Card Type Selection -->
                        <div class="form-group mb-6">
                            <label class="form-label">Card Type</label>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="relative">
                                    <input type="radio" name="card-type" value="virtual" id="virtual-type" class="hidden" checked>
                                    <label for="virtual-type" class="block p-4 border border-gray-700 rounded-lg cursor-pointer hover:border-accent-yellow transition-colors">
                                        <div class="flex items-center gap-3">
                                            <i class="fas fa-mobile-alt text-accent-yellow text-xl"></i>
                                            <div>
                                                <div class="font-semibold">Virtual Card</div>
                                                <div class="text-sm text-gray-400">Instant activation</div>
                                            </div>
                                        </div>
                                    </label>
                                </div>
                                <div class="relative">
                                    <input type="radio" name="card-type" value="physical" id="physical-type" class="hidden">
                                    <label for="physical-type" class="block p-4 border border-gray-700 rounded-lg cursor-pointer hover:border-accent-yellow transition-colors">
                                        <div class="flex items-center gap-3">
                                            <i class="fas fa-credit-card text-accent-yellow text-xl"></i>
                                            <div>
                                                <div class="font-semibold">Physical Card</div>
                                                <div class="text-sm text-gray-400">Shipped to your address</div>
                                            </div>
                                        </div>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Personal Information -->
                        <div class="space-y-4">
                            <h3 class="text-lg font-semibold">Personal Information</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label for="card-holder-name" class="form-label">Full Name</label>
                                    <input type="text" id="card-holder-name" class="form-input" placeholder="As it appears on your ID" required>
                                </div>
                                <div class="form-group">
                                    <label for="card-email" class="form-label">Email Address</label>
                                    <input type="email" id="card-email" class="form-input" placeholder="For important notifications" required>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="form-group">
                                    <label for="card-phone" class="form-label">Phone Number</label>
                                    <input type="tel" id="card-phone" class="form-input" placeholder="For verification purposes" required>
                                </div>
                                <div class="form-group">
                                    <label for="card-country" class="form-label">Country</label>
                                    <select id="card-country" class="form-select" required>
                                        <option value="">Select your country</option>
                                        <option value="US">United States</option>
                                        <option value="UK">United Kingdom</option>
                                        <option value="CA">Canada</option>
                                        <!-- Add more countries -->
                                    </select>
                                </div>
                            </div>

                            <!-- Shipping Address (for physical cards) -->
                            <div id="shipping-address-section" class="hidden">
                                <h3 class="text-lg font-semibold mt-6 mb-4">Shipping Address</h3>
                                <div class="space-y-4">
                                    <div class="form-group">
                                        <label for="shipping-address" class="form-label">Street Address</label>
                                        <input type="text" id="shipping-address" class="form-input" placeholder="Enter your street address">
                                    </div>
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        <div class="form-group">
                                            <label for="shipping-city" class="form-label">City</label>
                                            <input type="text" id="shipping-city" class="form-input" placeholder="Enter city">
                                        </div>
                                        <div class="form-group">
                                            <label for="shipping-state" class="form-label">State/Province</label>
                                            <input type="text" id="shipping-state" class="form-input" placeholder="Enter state">
                                        </div>
                                        <div class="form-group">
                                            <label for="shipping-zip" class="form-label">Postal Code</label>
                                            <input type="text" id="shipping-zip" class="form-input" placeholder="Enter postal code">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Terms and Conditions -->
                        <div class="form-group mt-6">
                            <label class="flex items-start gap-3">
                                <input type="checkbox" required class="mt-1">
                                <span class="text-sm text-gray-400">I agree to the <a href="#" class="text-accent-yellow hover:underline">Terms and Conditions</a> and acknowledge the <a href="#" class="text-accent-yellow hover:underline">Privacy Policy</a>. I understand that my card will be subject to the selected tier's fees and limits.</span>
                            </label>
                        </div>

                        <button type="submit" class="btn-submit-card mt-6">Submit Card Request</button>
                    </form>
                </div>
            </div>
            <div class="modal" id="notification-modal">
                <div class="modal-content"><div class="modal-header"><h2 class="modal-title" id="notification-title"></h2><button class="modal-close-btn" data-modal-id="notification-modal"><i class="fas fa-times"></i></button></div><p id="notification-message" class="text-sm text-center text-secondary"></p></div>
            </div>
            <div class="modal" id="deposit-modal">
                <div class="modal-content"><div class="modal-header"><h2 class="modal-title">Deposit Crypto</h2><button class="modal-close-btn" data-modal-id="deposit-modal"><i class="fas fa-times"></i></button></div><div class="form-group"><label for="deposit-asset-select" class="form-label">Select Asset</label><select id="deposit-asset-select" class="form-select"></select></div><div class="text-center"><div id="deposit-qr-code" class="qr-code-container"></div><p class="text-sm text-secondary mt-2">Scan QR code or copy address below</p><input type="text" id="deposit-address" class="form-input text-center mt-2" readonly /><button id="generate-address-btn" class="btn-submit-card mt-4">Generate New Address</button></div></div>
            </div>
            <div class="modal" id="withdraw-modal">
                <div class="modal-content"><div class="modal-header"><h2 class="modal-title">Withdraw Crypto</h2><button class="modal-close-btn" data-modal-id="withdraw-modal"><i class="fas fa-times"></i></button></div><form id="withdraw-form"><div class="form-group"><label for="withdraw-asset-select" class="form-label">Select Asset</label><select id="withdraw-asset-select" class="form-select"></select></div><div class="form-group"><label for="withdraw-amount" class="form-label">Amount</label><input type="number" step="any" id="withdraw-amount" class="form-input" required /></div><div class="form-group"><label for="withdraw-address" class="form-label">Recipient Address</label><input type="text" id="withdraw-address" class="form-input" required /></div><button type="submit" class="btn-submit-card">Submit Withdrawal</button></form></div>
            </div>
            <div class="modal" id="set-pin-modal">
                <div class="modal-content"><div class="modal-header"><h2 class="modal-title">Set PIN for Card <span id="pin-card-number"></span></h2><button class="modal-close-btn" data-modal-id="set-pin-modal"><i class="fas fa-times"></i></button></div><form id="set-pin-form"><input type="hidden" id="set-pin-card-id"><div class="form-group"><label for="new-pin" class="form-label">New PIN (4 digits)</label><input type="password" id="new-pin" class="form-input" placeholder="â€¢â€¢â€¢â€¢" required maxlength="4" pattern="\d{4}" /></div><div class="form-group" id="confirm-pin-group"><label for="confirm-pin" class="form-label">Confirm New PIN</label><input type="password" id="confirm-pin" class="form-input" placeholder="â€¢â€¢â€¢â€¢" required maxlength="4" pattern="\d{4}" /></div><button type="submit" class="btn-submit-card">Set PIN</button></form></div>
            </div>
            <!-- Bank Transfer Withdrawal Modal -->
            <div id="bank-withdrawal-modal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 class="modal-title">Bank Transfer Withdrawal</h2>
                        <button class="modal-close-btn" data-modal-id="bank-withdrawal-modal"><i class="fas fa-times"></i></button>
                    </div>
                    <form id="bank-withdrawal-form">
                        <div class="form-group">
                            <label class="form-label">Bank Account Name</label>
                            <input type="text" class="form-input" id="bank-account-name" required>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Bank Name</label>
                                <input type="text" class="form-input" id="bank-name" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Account Type</label>
                                <select class="form-select" id="bank-account-type" required>
                                    <option value="checking">Checking</option>
                                    <option value="savings">Savings</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Account Number</label>
                            <input type="text" class="form-input" id="bank-account-number" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Routing Number</label>
                            <input type="text" class="form-input" id="bank-routing-number" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Amount (USD)</label>
                            <input type="number" class="form-input" id="bank-amount" min="100" step="0.01" required>
                            <small class="text-gray-400">Minimum withdrawal: $100.00</small>
                        </div>
                        <div class="text-sm text-gray-400 mb-4">
                            <div class="flex items-center gap-2 mb-1">
                                <i class="fas fa-info-circle"></i>
                                Fee: $5.00 flat rate
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fas fa-clock"></i>
                                Processing time: 1-3 business days
                            </div>
                        </div>
                        <button type="submit" class="btn-submit-card">Proceed with Bank Transfer</button>
                    </form>
                </div>
            </div>

            <!-- Card Withdrawal Modal -->
            <div id="card-withdrawal-modal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 class="modal-title">Card Withdrawal</h2>
                        <button class="modal-close-btn" data-modal-id="card-withdrawal-modal"><i class="fas fa-times"></i></button>
                    </div>
                    <form id="card-withdrawal-form">
                        <div class="form-group">
                            <label class="form-label">Select Card</label>
                            <select class="form-select" id="withdrawal-card-select" required>
                                <option value="">Choose a card</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Amount (USD)</label>
                            <input type="number" class="form-input" id="card-amount" min="10" step="0.01" required>
                            <small class="text-gray-400">Minimum withdrawal: $10.00</small>
                        </div>
                        <div class="text-sm text-gray-400 mb-4">
                            <div class="flex items-center gap-2 mb-1">
                                <i class="fas fa-info-circle"></i>
                                Fee: 2.5% of withdrawal amount
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fas fa-bolt"></i>
                                Instant processing
                            </div>
                        </div>
                        <button type="submit" class="btn-submit-card">Proceed with Card Withdrawal</button>
                    </form>
                </div>
            </div>

            <!-- Crypto Withdrawal Modal -->
            <div id="crypto-withdrawal-modal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 class="modal-title">Crypto Withdrawal</h2>
                        <button class="modal-close-btn" data-modal-id="crypto-withdrawal-modal"><i class="fas fa-times"></i></button>
                    </div>
                    <form id="crypto-withdrawal-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Select Asset</label>
                                <select class="form-select" id="crypto-asset-select" required>
                                    <option value="">Choose an asset</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Network</label>
                                <select class="form-select" id="crypto-network-select" required>
                                    <option value="">Select network</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Withdrawal Address</label>
                            <input type="text" class="form-input" id="crypto-address" required>
                            <small class="text-gray-400">Double-check the address to avoid loss of funds</small>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Amount</label>
                            <div class="relative">
                                <input type="number" class="form-input" id="crypto-amount" step="any" required>
                                <button type="button" class="absolute right-2 top-1/2 transform -translate-y-1/2 text-accent-yellow text-sm" id="max-amount-btn">MAX</button>
                            </div>
                            <div class="flex justify-between mt-1">
                                <small class="text-gray-400">Available: <span id="available-crypto-balance">0.00</span></small>
                                <small class="text-gray-400">â‰ˆ $<span id="crypto-amount-usd">0.00</span></small>
                            </div>
                        </div>
                        <div class="text-sm text-gray-400 mb-4">
                            <div class="flex items-center gap-2 mb-1">
                                <i class="fas fa-info-circle"></i>
                                Network fee: <span id="network-fee">0.00</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <i class="fas fa-clock"></i>
                                Estimated time: 10-30 minutes
                            </div>
                        </div>
                        <div class="bg-yellow-900/20 border border-yellow-700/30 rounded-lg p-4 mb-4">
                            <div class="flex items-start gap-3">
                                <i class="fas fa-exclamation-triangle text-yellow-500 mt-1"></i>
                                <div class="text-sm text-yellow-500">
                                    <p class="font-semibold mb-1">Important</p>
                                    <ul class="list-disc pl-4 space-y-1">
                                        <li>Ensure the receiving address supports the selected network</li>
                                        <li>Withdrawals cannot be reversed once processed</li>
                                        <li>Minimum withdrawal amount: $50.00 equivalent</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <button type="submit" class="btn-submit-card">Proceed with Crypto Withdrawal</button>
                    </form>
                </div>
            </div>
            <div id="kyc-modal" class="modal">
                <div class="modal-content modal-lg"><div class="modal-header"><h2 class="modal-title flex items-center gap-2"><i class="fas fa-shield-alt text-accent-yellow"></i> Identity Verification</h2><button class="modal-close-btn" data-modal-id="kyc-modal"><i class="fas fa-times"></i></button></div><div class="flex items-center justify-between mb-8 relative"><div class="absolute left-0 right-0 top-1/2 h-1 bg-gray-700 -z-1"></div><div class="progress-step"><div class="progress-circle active bg-gray-800" data-step="1"><i class="fas fa-user text-accent-yellow"></i></div><div class="text-sm mt-2">Personal Info</div></div><div class="progress-step"><div class="progress-circle bg-gray-800" data-step="2"><i class="fas fa-address-book"></i></div><div class="text-sm mt-2">Contact Details</div></div><div class="progress-step"><div class="progress-circle bg-gray-800" data-step="3"><i class="fas fa-id-card"></i></div><div class="text-sm mt-2">ID Verification</div></div></div><div class="kyc-step active" data-step="1"><h3 class="text-lg font-semibold mb-4">Personal Information</h3><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div class="form-group"><label class="form-label">Legal First Name</label><input type="text" class="form-input" placeholder="Enter your legal first name"></div><div class="form-group"><label class="form-label">Legal Last Name</label><input type="text" class="form-input" placeholder="Enter your legal last name"></div><div class="form-group"><label class="form-label">Date of Birth</label><input type="date" class="form-input"></div><div class="form-group"><label class="form-label">Gender</label><select class="form-select"><option value="">Select your gender</option><option value="male">Male</option><option value="female">Female</option><option value="other">Other</option><option value="prefer-not">Prefer not to say</option></select></div><div class="form-group"><label class="form-label">Nationality</label><select class="form-select" id="nationality-select"><option value="">Select your nationality</option></select></div><div class="form-group"><label class="form-label">Country of Residence</label><select class="form-select" id="country-select"><option value="">Select your country</option></select></div></div></div><div class="kyc-step hidden" data-step="2"><h3 class="text-lg font-semibold mb-4">Contact Details</h3><div class="space-y-4"><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div class="form-group"><label class="form-label">Phone Number</label><input type="tel" class="form-input" placeholder="Enter your phone number"></div><div class="form-group"><label class="form-label">Email Address</label><input type="email" class="form-input" placeholder="Enter your email address"></div></div><div class="form-group"><label class="form-label">Street Address</label><input type="text" class="form-input" placeholder="Enter your street address"></div><div class="grid grid-cols-1 md:grid-cols-3 gap-4"><div class="form-group"><label class="form-label">City</label><input type="text" class="form-input" placeholder="Enter your city"></div><div class="form-group"><label class="form-label">State/Province</label><input type="text" class="form-input" placeholder="Enter your state/province"></div><div class="form-group"><label class="form-label">Postal Code</label><input type="text" class="form-input" placeholder="Enter your postal code"></div></div></div></div><div class="kyc-step hidden" data-step="3"><h3 class="text-lg font-semibold mb-4">Identity Verification</h3><div class="space-y-6"><div class="form-group"><label class="form-label">ID Document Type</label><select class="form-select" id="id-document-type" onchange="toggleBackSide()"><option value="">Select document type</option><option value="passport">Passport</option><option value="national-id">National ID</option><option value="driving-license">Driving License</option></select></div><div class="space-y-4"><div class="p-4 bg-gray-800 rounded-lg"><div class="flex items-center gap-3 mb-2"><i class="fas fa-id-card text-accent-yellow"></i><div class="font-semibold">Document Upload</div></div><div class="border-2 border-dashed border-gray-700 rounded-lg p-4 text-center"><i class="fas fa-cloud-upload-alt text-2xl mb-2 text-accent-yellow"></i><div class="text-sm text-gray-400">Drag and drop or click to upload your document</div></div></div><div class="p-4 bg-gray-800 rounded-lg" id="back-side-upload" style="display: none;"><div class="flex items-center gap-3 mb-2"><i class="fas fa-id-card text-accent-yellow"></i><div class="font-semibold">Back Side</div></div><div class="border-2 border-dashed border-gray-700 rounded-lg p-4 text-center"><i class="fas fa-cloud-upload-alt text-2xl mb-2 text-accent-yellow"></i><div class="text-sm text-gray-400">Drag and drop or click to upload back side</div></div></div></div><div class="text-sm text-gray-400"><div class="flex items-center gap-2 mb-1"><i class="fas fa-check-circle text-accent-green"></i> Document must be valid and not expired</div><div class="flex items-center gap-2 mb-1"><i class="fas fa-check-circle text-accent-green"></i> All details must be clearly visible</div><div class="flex items-center gap-2 mb-1"><i class="fas fa-check-circle text-accent-green"></i> Images must be in color and high resolution</div></div></div></div><div class="flex justify-between mt-6"><button class="btn-action btn-secondary kyc-prev hidden" style="width: auto; padding-left: 20px; padding-right: 20px;"><i class="fas fa-arrow-left mr-2"></i> Previous</button><button class="btn-action kyc-next" style="width: auto; padding-left: 20px; padding-right: 20px;">Next <i class="fas fa-arrow-right ml-2"></i></button></div></div>
            </div>
            <div id="card-details-modal" class="modal">
                <div class="modal-content modal-lg"><div class="modal-header"><h2 class="modal-title flex items-center gap-2"><i class="fas fa-credit-card text-yellow-400"></i>Card Details</h2><button class="modal-close-btn" data-modal-id="card-details-modal">&times;</button></div><div class="grid gap-4"><div class="relative w-full max-w-md mx-auto" style="aspect-ratio: 16/10;"><div class="virtual-card-container" id="details-card-flipper" onclick="this.classList.toggle('flipped')"><div class="virtual-card-front p-5" id="details-card-front"></div><div class="virtual-card-back p-5" id="details-card-back"></div></div></div><div class="flex items-center justify-between mt-2"><span class="text-text-secondary text-sm">Card Number: <span id="cd-full-number" class="font-mono"></span></span><button class="btn-secondary px-4 py-2 rounded-lg text-sm" onclick="copyToClipboard('cd-full-number')"><i class="fas fa-copy"></i> Copy</button></div><div class="grid md:grid-cols-2 gap-4 text-sm mt-4"><div><label class="text-text-secondary">Tier</label><div id="cd-tier" class="font-medium capitalize"></div></div><div><label class="text-text-secondary">Card Type</label><div id="cd-physical-status" class="font-medium capitalize"></div></div><div><label class="text-text-secondary">Limits</label><div id="cd-limits" class="font-medium"></div></div><div><label class="text-text-secondary">Status</label><div id="cd-status" class="status-badge"></div></div></div></div></div>
            </div>
            <div class="modal" id="lock-reason-modal">
                <div class="modal-content"><div class="modal-header"><h2 class="modal-title">Card Request Unavailable</h2><button class="modal-close-btn" data-modal-id="lock-reason-modal"><i class="fas fa-times"></i></button></div><p id="lock-reason-message" class="text-base text-center text-secondary"></p></div>
            </div>
            <div class="modal" id="card-limits-modal">
                <div class="modal-content"><div class="modal-header"><h2 class="modal-title">Card Limits</h2><button class="modal-close-btn" data-modal-id="card-limits-modal"><i class="fas fa-times"></i></button></div><div id="card-limits-content"></div></div>
            </div>
            <!-- Profile Modals -->
            <div class="modal" id="change-name-modal">
                <div class="modal-content">
                    <div class="modal-header"><h2 class="modal-title">Change Full Name</h2><button class="modal-close-btn" data-modal-id="change-name-modal"><i class="fas fa-times"></i></button></div>
                    <form id="change-name-form">
                        <div class="form-group">
                            <label for="new-full-name" class="form-label">New Full Name</label>
                            <input type="text" id="new-full-name" class="form-input" required />
                        </div>
                        <button type="submit" class="btn-submit-card">Save Changes</button>
                    </form>
                </div>
            </div>
            <div class="modal" id="change-email-modal">
                <div class="modal-content">
                    <div class="modal-header"><h2 class="modal-title">Change Email Address</h2><button class="modal-close-btn" data-modal-id="change-email-modal"><i class="fas fa-times"></i></button></div>
                    <form id="change-email-form">
                        <div class="form-group">
                            <label for="new-email" class="form-label">New Email Address</label>
                            <input type="email" id="new-email" class="form-input" required />
                        </div>
                        <button type="submit" class="btn-submit-card">Save Changes</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        /* ---------- KYC DOCUMENT UPLOAD LOGIC ---------- */
        function toggleBackSide() {
            const docType = document.getElementById('id-document-type').value;
            const backSideUpload = document.getElementById('back-side-upload');
            // Show back side upload only for national ID and driving license
            backSideUpload.style.display = (docType === 'national-id' || docType === 'driving-license') ? 'block' : 'none';
        }

        /* ---------- CARD REQUEST MODAL LOGIC ---------- */
        function initCardRequestModal() {
            const cardTypeOptions = document.querySelectorAll('input[name="card-type"]');
            const shippingAddressSection = document.getElementById('shipping-address-section');
            const cardTierOptions = document.querySelectorAll('.card-type-option');

            // Handle card type selection (Virtual/Physical)
            cardTypeOptions.forEach(option => {
                option.addEventListener('change', (e) => {
                    const isPhysical = e.target.value === 'physical';
                    shippingAddressSection.classList.toggle('hidden', !isPhysical);
                    
                    // Update required attributes for shipping fields
                    const shippingInputs = shippingAddressSection.querySelectorAll('input');
                    shippingInputs.forEach(input => {
                        input.required = isPhysical;
                    });

                    // Visual feedback for selection
                    document.querySelectorAll('[for="virtual-type"], [for="physical-type"]').forEach(label => {
                        label.classList.remove('border-accent-yellow', 'bg-gray-800');
                    });
                    e.target.parentElement.querySelector('label').classList.add('border-accent-yellow', 'bg-gray-800');
                });
            });

            // Handle card tier selection
            cardTierOptions.forEach(option => {
                option.addEventListener('click', () => {
                    // Remove selection from all options
                    cardTierOptions.forEach(opt => opt.classList.remove('selected', 'border-accent-yellow', 'bg-gray-800'));
                    // Add selection to clicked option
                    option.classList.add('selected', 'border-accent-yellow', 'bg-gray-800');
                    // Update hidden input for form submission
                    document.querySelector('#card-type').value = option.dataset.tier;
                });
            });
        }

        /* ---------- APP STATE & VIEW MANAGEMENT ---------- */
        const landingPageContainer = document.getElementById('landing-page-container');
        const dashboardContainer = document.getElementById('dashboard-container');
        let userProfile = {
            name: 'John Doe',
            email: 'john.doe@email.com'
        };

        function showDashboard() {
            landingPageContainer.classList.add('hidden');
            dashboardContainer.classList.remove('hidden');
        }

        function showLandingPage() {
            dashboardContainer.classList.add('hidden');
            landingPageContainer.classList.remove('hidden');
        }

        function initAppSwitcher() {
            document.querySelectorAll('.app-switch-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    showDashboard();
                });
            });
            document.querySelector('.logout-link').addEventListener('click', (e) => {
                e.preventDefault();
                showLandingPage();
            });
             document.querySelector('#logout-button-dropdown').addEventListener('click', (e) => {
                e.preventDefault();
                showLandingPage();
            });
        }


        /* ---------- LANDING PAGE LOGIC ---------- */
        function initLandingPage() {
          const io=new IntersectionObserver(entries=>{
            entries.forEach(e=>{if(e.isIntersecting){e.target.classList.add('is-visible');io.unobserve(e.target)}})
          },{threshold:.15});
          document.querySelectorAll('#landing-page-container .fade-in').forEach(el=>io.observe(el));
        }

        /* ---------- DASHBOARD LOGIC ---------- */
        function initDashboard() {
            // Initialize card request modal
            initCardRequestModal();

            /* ---------- SIDEBAR SLIDE-OUT TOGGLE ---------- */
            const sidebar = document.getElementById('sidebar');
            const mobileNavToggle = document.getElementById('mobile-nav-toggle');
            const sidebarOverlay = document.getElementById('sidebar-overlay');
            const closeSidebarBtn = document.getElementById('close-sidebar');

            function toggleSidebar() {
                sidebar.classList.toggle('active');
                sidebarOverlay.classList.toggle('active');
            }

            mobileNavToggle.addEventListener('click', toggleSidebar);
            closeSidebarBtn.addEventListener('click', toggleSidebar);
            sidebarOverlay.addEventListener('click', toggleSidebar);

            window.addEventListener('resize', () => {
                if (window.innerWidth >= 1025) {
                    sidebar.classList.remove('active');
                    sidebarOverlay.classList.remove('active');
                }
            });

            /* ---------- PAGE CONTENT SWITCHING ---------- */
            const pageLinks = document.querySelectorAll('.menu-link');
            const pageContents = document.querySelectorAll('.page-content');
            const pageTitle = document.getElementById('page-title');
            const pageSubtitle = document.getElementById('page-subtitle');

            const pageMap = {
                'dashboard': { title: 'Dashboard', subtitle: 'Overview of your account' },
                'crypto-assets': { title: 'Crypto Assets', subtitle: 'Overview of your crypto assets' },
                'cards': { title: 'Cards', subtitle: 'Manage your cards and finances' },
                'withdrawals': { title: 'Withdrawals', subtitle: 'Manage your fund withdrawals' },
                'transactions': { title: 'Transaction History', subtitle: 'Your recent transactions' },
                'notifications': { title: 'Notifications', subtitle: 'Manage your notification preferences' },
                'settings': { title: 'Settings', subtitle: 'Customize your account settings' },
                'profile': { title: 'Profile', subtitle: 'View and edit your profile' }
            };

            function showPage(pageId) {
                if (pageMap[pageId]) {
                    pageTitle.textContent = pageMap[pageId].title;
                    pageSubtitle.textContent = pageMap[pageId].subtitle;
                }
                pageContents.forEach(page => {
                    page.classList.remove('active');
                    page.classList.add('hidden');
                });
                const currentPage = document.getElementById(`${pageId}-page`);
                if (currentPage) {
                    currentPage.classList.add('active');
                    currentPage.classList.remove('hidden');
                }
                 pageLinks.forEach(link => {
                    link.classList.toggle('active', link.dataset.page === pageId);
                });
                
                if (pageId === 'crypto-assets') renderCryptoAssetsPage();
                else if (pageId === 'transactions') renderTransactionsPage();
                else if (pageId === 'withdrawals') renderWithdrawalsPage();
                else if (pageId === 'notifications') renderNotificationsPage();
            }

            function handleNavigation(e, pageId) {
                e.preventDefault();
                showPage(pageId);
                if (window.innerWidth < 1025) toggleSidebar();
                const userDropdown = document.getElementById('user-dropdown');
                if (userDropdown) userDropdown.classList.add('hidden');
            }

            pageLinks.forEach(link => {
                link.addEventListener('click', e => {
                    const pageId = link.dataset.page;
                    handleNavigation(e, pageId);
                });
            });
            
            // Withdrawal Methods Handlers
            document.querySelectorAll('.method-card').forEach(methodCard => {
                methodCard.addEventListener('click', function() {
                    // Remove selected class from all method cards
                    document.querySelectorAll('.method-card').forEach(card => {
                        card.classList.remove('selected');
                    });
                    
                    // Add selected class to clicked card
                    this.classList.add('selected');
                    
                    // Get the withdrawal method type
                    const methodType = this.getAttribute('data-method');
                    
                    // Show corresponding modal based on method type
                    let modalId;
                    switch(methodType) {
                        case 'bank':
                            modalId = 'bank-withdrawal-modal';
                            break;
                        case 'card':
                            modalId = 'card-withdrawal-modal';
                            // Populate card select options
                            const cardSelect = document.getElementById('withdrawal-card-select');
                            cardSelect.innerHTML = '<option value="">Choose a card</option>';
                            cardData.forEach(card => {
                                if (card.status === 'active' && !card.isFrozen) {
                                    cardSelect.innerHTML += `<option value="${card.id}">**** **** **** ${card.cardNumber.slice(-4)}</option>`;
                                }
                            });
                            break;
                        case 'crypto':
                            modalId = 'crypto-withdrawal-modal';
                            // Populate crypto asset select options
                            const assetSelect = document.getElementById('crypto-asset-select');
                            assetSelect.innerHTML = '<option value="">Choose an asset</option>';
                            cryptoData.forEach(asset => {
                                if (asset.balance > 0) {
                                    assetSelect.innerHTML += `<option value="${asset.id}">${asset.asset} (${asset.ticker})</option>`;
                                }
                            });
                            break;
                    }
                    
                    if (modalId) {
                        document.getElementById(modalId).classList.add('active');
                    }
                });
            });
            
            // Handle crypto asset selection change
            document.getElementById('crypto-asset-select')?.addEventListener('change', function() {
                const selectedAsset = cryptoData.find(asset => asset.id === this.value);
                if (selectedAsset) {
                    document.getElementById('available-crypto-balance').textContent = 
                        `${selectedAsset.balance} ${selectedAsset.ticker}`;
                    // Populate networks based on selected asset
                    const networkSelect = document.getElementById('crypto-network-select');
                    networkSelect.innerHTML = '<option value="">Select network</option>';
                    switch(selectedAsset.ticker) {
                        case 'ETH':
                            networkSelect.innerHTML += `
                                <option value="ETH">Ethereum (ERC20)</option>
                                <option value="BSC">BSC (BEP20)</option>
                                <option value="ARBITRUM">Arbitrum One</option>
                            `;
                            break;
                        case 'BTC':
                            networkSelect.innerHTML += `
                                <option value="BTC">Bitcoin</option>
                                <option value="LIGHTNING">Lightning Network</option>
                            `;
                            break;
                        // Add more cases for other assets
                        default:
                            networkSelect.innerHTML += `<option value="${selectedAsset.ticker}">${selectedAsset.asset} Network</option>`;
                    }
                }
            });
            
            // Handle crypto amount input
            document.getElementById('crypto-amount')?.addEventListener('input', function() {
                const selectedAsset = cryptoData.find(
                    asset => asset.id === document.getElementById('crypto-asset-select').value
                );
                if (selectedAsset) {
                    const amount = parseFloat(this.value) || 0;
                    const usdValue = amount * selectedAsset.price;
                    document.getElementById('crypto-amount-usd').textContent = usdValue.toFixed(2);
                }
            });
            
            // Handle MAX button click
            document.getElementById('max-amount-btn')?.addEventListener('click', function() {
                const selectedAsset = cryptoData.find(
                    asset => asset.id === document.getElementById('crypto-asset-select').value
                );
                if (selectedAsset) {
                    document.getElementById('crypto-amount').value = selectedAsset.balance;
                    const usdValue = selectedAsset.balance * selectedAsset.price;
                    document.getElementById('crypto-amount-usd').textContent = usdValue.toFixed(2);
                }
            });
            
            // Handle form submissions
            ['bank-withdrawal-form', 'card-withdrawal-form', 'crypto-withdrawal-form'].forEach(formId => {
                document.getElementById(formId)?.addEventListener('submit', function(e) {
                    e.preventDefault();
                    // Show success message
                    showNotification('Success', 'Withdrawal request submitted successfully');
                    // Close the modal
                    this.closest('.modal').classList.remove('active');
                });
            });
            
            document.querySelectorAll('#user-dropdown [data-page]').forEach(link => {
                link.addEventListener('click', e => {
                    const pageId = link.dataset.page;
                    handleNavigation(e, pageId);
                });
            });
            
            document.getElementById('wallet-button').addEventListener('click', () => {
                showPage('crypto-assets');
            });

            /* ---------- MODAL LOGIC ---------- */
            function setupModals() {
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.addEventListener('click', (e) => {
                        if (e.target === modal) modal.classList.remove('active');
                    });
                });
                document.querySelectorAll('[data-modal-id]').forEach(btn => {
                    btn.addEventListener('click', () => {
                        document.getElementById(btn.dataset.modalId).classList.remove('active');
                    });
                });
                 document.getElementById('card-actions-btn').addEventListener('click', () => showPage('cards'));
                 document.getElementById('requestNewBtn').addEventListener('click', () => document.getElementById('request-card-modal').classList.add('active'));
                // openDepositModal function removed - handled by CryptoManager
                // Deposit button handler moved to CryptoManager
                // Crypto page deposit button handler moved to CryptoManager
                document.getElementById('withdraw-btn').addEventListener('click', () => showPage('withdrawals'));
                document.getElementById('crypto-page-withdraw-btn').addEventListener('click', () => showPage('withdrawals'));
                document.getElementById('start-kyc-btn').addEventListener('click', () => { document.getElementById('kyc-modal').classList.add('active'); });

                document.getElementById('change-name-btn').addEventListener('click', () => {
                    document.getElementById('new-full-name').value = userProfile.name;
                    document.getElementById('change-name-modal').classList.add('active');
                });

                document.getElementById('change-email-btn').addEventListener('click', () => {
                    document.getElementById('new-email').value = userProfile.email;
                    document.getElementById('change-email-modal').classList.add('active');
                });
            }

            function showNotification(title, message) {
                document.getElementById('notification-title').textContent = title;
                document.getElementById('notification-message').textContent = message;
                document.getElementById('notification-modal').classList.add('active');
                setTimeout(() => {
                     document.getElementById('notification-modal').classList.remove('active');
                }, 3000);
            }

            /* ---------- DATA STORE ---------- */
            let cryptoData = [
                { id: 'bitcoin', asset: 'Bitcoin', ticker: 'BTC', icon: 'https://raw.githubusercontent.com/atomiclabs/cryptocurrency-icons/master/128/color/btc.png', price: 68123.45, change: 2.5, balance: 0.03, addresses: ['1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa', '1BvBMSEYstWetqTFn5Au4m4GFg7xJaNVN2', '1J7mdg5rbQyUHENYdx39WVWK7fsLpEoXZy'] },
                { id: 'ethereum', asset: 'Ethereum', ticker: 'ETH', icon: 'https://raw.githubusercontent.com/atomiclabs/cryptocurrency-icons/master/128/color/eth.png', price: 3456.78, change: -1.2, balance: 0.4, addresses: ['0xde0B295669a9FD93d5F28D9Ec85E40f4cb697BAe', '0x225555a867495933446684E2b4A2755104A41E1A', '0x336666a867495933446684E2b4A2755104A41E1A'] },
                { id: 'binancecoin', asset: 'BNB', ticker: 'BNB', icon: 'https://raw.githubusercontent.com/atomiclabs/cryptocurrency-icons/master/128/color/bnb.png', price: 589.50, change: 0.8, balance: 2, addresses: ['bnb136ns6lfw4s5g68weua029l4hsx4kpjz4g2g4gq', 'bnb1a2s3d4f5g6h7j8k9l0p1o2i3u4y5t6r7e8w9q', 'bnb1z2x3c4v5b6n7m8q9w0e1r2t3y4u5i6o7p8s9d'] },
                { id: 'solana', asset: 'Solana', ticker: 'SOL', icon: 'https://raw.githubusercontent.com/atomiclabs/cryptocurrency-icons/master/128/color/sol.png', price: 150.25, change: 5.1, balance: 5, addresses: ['So11111111111111111111111111111111111111112', 'So22222222222222222222222222222222222222222', 'So33333333333333333333333333333333333333333'] },
                { id: 'cardano', asset: 'Cardano', ticker: 'ADA', icon: 'https://raw.githubusercontent.com/atomiclabs/cryptocurrency-icons/master/128/color/ada.png', price: 0.45, change: -0.5, balance: 50, addresses: ['addr1q8z8q8z8q8z8q8z8q8z8q8z8q8z8q8z8q8z8q8z8q8z8q8z8q8z8q8z', 'addr1q9z9z9z9z9z9z9z9z9z9z9z9z9z9z9z9z9z9z9z9z9z9z9z9z9z9z9z', 'addr1q0z0z0z0z0z0z0z0z0z0z0z0z0z0z0z0z0z0z0z0z0z0z0z0z0z0z0z'] },
                { id: 'tron', asset: 'Tron', ticker: 'TRX', icon: 'https://raw.githubusercontent.com/atomiclabs/cryptocurrency-icons/master/128/color/trx.png', price: 0.12, change: 1.1, balance: 1000, addresses: ['TPL2uTAm4tFdXnD2e6a4P2B123456789012345678', 'TPApr2uTAm4tFdXnD2e6a4P2Babcdefghijklm', 'TPBpr2uTAm4tFdXnD2e6a4P2Bnopqrstuvwxyz'] },
                { id: 'tether', asset: 'USDT', ticker: 'USDT', icon: 'https://raw.githubusercontent.com/atomiclabs/cryptocurrency-icons/master/128/color/usdt.png', price: 1.00, change: 0.0, balance: 500, addresses: ['TPL2uTAm4tFdXnD2e6a4P2B123456789012345678', 'TPApr2uTAm4tFdXnD2e6a4P2Babcdefghijklm', 'TPBpr2uTAm4tFdXnD2e6a4P2Bnopqrstuvwxyz'] },
                { id: 'ripple', asset: 'XRP', ticker: 'XRP', icon: 'https://raw.githubusercontent.com/atomiclabs/cryptocurrency-icons/master/128/color/xrp.png', price: 0.52, change: -2.3, balance: 200, addresses: ['rP12345678901234567890123456789012345', 'rPabcdefghijklmnopqrstuvwxyz123456789', 'rPnopqrstuvwxyzabcdefghijklm123456789'] },
                { id: 'dogecoin', asset: 'Dogecoin', ticker: 'DOGE', icon: 'https://raw.githubusercontent.com/atomiclabs/cryptocurrency-icons/master/128/color/doge.png', price: 0.15, change: 3.2, balance: 5000, addresses: ['D123456789012345678901234567890123', 'Dabcdefghijklmnopqrstuvwxyz123456789', 'Dnopqrstuvwxyzabcdefghijklm123456789'] },
                { id: 'litecoin', asset: 'Litecoin', ticker: 'LTC', icon: 'https://raw.githubusercontent.com/atomiclabs/cryptocurrency-icons/master/128/color/ltc.png', price: 85.60, change: 0.5, balance: 10, addresses: ['ltc1q8z8q8z8q8z8q8z8q8z8q8z8q8z8q8z8q8z8q8z8q8z8q8z8q8z8q8z', 'ltc1q9z9z9z9z9z9z9z9z9z9z9z9z9z9z9z9z9z9z9z9z9z9z9z9z9z9z9z', 'ltc1q0z0z0z0z0z0z0z0z0z0z0z0z0z0z0z0z0z0z0z0z0z0z0z0z0z0z0z'] },
                { id: 'sui', asset: 'Sui', ticker: 'SUI', icon: '', price: 1.05, change: -1.5, balance: 0, addresses: ['', '', ''] },
                { id: 'pengu', asset: 'Pengu', ticker: 'PENGU', icon: '', price: 0.002, change: 10.5, balance: 0, addresses: ['', '', ''] },
                { id: 'zbcn', asset: 'ZBCN', ticker: 'ZBCN', icon: '', price: 0.03, change: 2.1, balance: 0, addresses: ['', '', ''] },
                { id: 'casper-network', asset: 'Casper', ticker: 'CSPR', icon: '', price: 0.04, change: -0.8, balance: 0, addresses: ['', '', ''] },
                { id: 'pepe', asset: 'Pepe', ticker: 'PEPE', icon: '', price: 0.000007, change: 8.4, balance: 0, addresses: ['', '', ''] },
                { id: 'bonk', asset: 'Bonk', ticker: 'BONK', icon: '', price: 0.000025, change: 4.2, balance: 0, addresses: ['', '', ''] },
                { id: 'swiftcoin', asset: 'SwiftCoin', ticker: 'SWIFT', icon: '', price: 1.20, change: 0.1, balance: 0, addresses: ['', '', ''] },
                { id: 'quant-network', asset: 'Quant', ticker: 'QNT', icon: '', price: 95.50, change: 1.8, balance: 0, addresses: ['', '', ''] },
                { id: 'lcx', asset: 'LCX', ticker: 'LCX', icon: '', price: 0.28, change: -3.1, balance: 0, addresses: ['', '', ''] },
                { id: 'shiba-inu', asset: 'Shiba Inu', ticker: 'SHIB', icon: '', price: 0.000025, change: 5.5, balance: 0, addresses: ['', '', ''] },
                { id: 'chainlink', asset: 'Chainlink', ticker: 'LINK', icon: '', price: 18.50, change: 2.9, balance: 0, addresses: ['', '', ''] },
                { id: 'link-api', asset: 'Link API', ticker: 'LINKAPI', icon: '', price: 0.10, change: -0.2, balance: 0, addresses: ['', '', ''] }
            ];
            let transactionData = [ { id:'#TXN891234',asset:'Bitcoin',icon:'https://raw.githubusercontent.com/atomiclabs/cryptocurrency-icons/master/128/color/btc.png',type:'Deposit',amount:'+0.5 BTC',fee:'0.0001 BTC',status:'Completed', date: new Date('2025-07-25T10:00:00Z') }, { id:'#TXN891233',asset:'Ethereum',icon:'https://raw.githubusercontent.com/atomiclabs/cryptocurrency-icons/master/128/color/eth.png',type:'Trade',amount:'+0.2 ETH',fee:'0.002 ETH',status:'Completed', date: new Date('2025-07-24T15:30:00Z') }, { id:'#TXN891232',asset:'Solana',icon:'https://raw.githubusercontent.com/atomiclabs/cryptocurrency-icons/master/128/color/sol.png',type:'Withdrawal',amount:'-2 SOL',fee:'0.001 SOL',status:'Pending', date: new Date('2025-07-23T09:00:00Z') }, ];
            let cardData = [ { id: 'card-1', userId: 'user-1', type: 'platinum', cardholderName: 'John Doe', cardNumber: '5123456789012345', expiry: '12/28', cvv: '123', balance: 1500.00, status: 'active', pin: '1234', isFrozen: false, physicalCardStatus: 'shipped', limits: { daily: 5000, monthly: 20000, contactless: 200 } }, { id: 'card-2', userId: 'user-2', type: 'gold', cardholderName: 'Jane Smith', cardNumber: '4123456789012345', expiry: '11/27', cvv: '456', balance: 2500.50, status: 'active', pin: '5678', isFrozen: false, physicalCardStatus: 'requested', limits: { daily: 2000, monthly: 10000, contactless: 100 } }, { id: 'card-3', userId: 'user-1', type: 'premium', cardholderName: 'John Doe', cardNumber: '3123456789012345', expiry: '10/26', cvv: '789', balance: 5000.75, status: 'active', pin: '9012', isFrozen: false, physicalCardStatus: 'none', limits: { daily: 1000, monthly: 5000, contactless: 50 } }, ];
            let notificationsData = [ { id: 'notif-1', message: 'Welcome to Chain-IQ!', timestamp: new Date(), read: false }, { id: 'notif-2', message: 'Your account has been successfully verified.', timestamp: new Date(), read: false }, ];
            let platformSettings = { appName: 'Chain-IQ', logoInitials: 'CIQ', logoColor: '#ffd75a', bgColor: '#0a0a0f', fontColor: '#f0f0f5', btnColor: '#5a8cff', cardColor: '#121218', cardBrandName: 'Chain-IQ', cardTypes: { platinum: { name: 'Platinum', color1: '#333333', color2: '#111111' }, gold: { name: 'Gold', color1: '#FFBF00', color2: '#FFBF00' }, premium: { name: 'Premium', color1: '#1A237E', color2: '#5C6BC0' } } };
            let displaySettings = { enableStackedView: true, stackedCardCount: 'all', stackedCardIds: [], lockCardRequests: false, lockReason: 'kyc', customLockMessage: '' };
            let userSettings = {
                currency: 'USD',
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                showCardBalance: true,
                onlineStatus: true,
                priceAlert: {
                    enabled: false,
                    assetId: null,
                    lastPrice: 0
                }
            };
            let exchangeRates = {};

            /* ---------- UTILITY FUNCTIONS ---------- */
            function formatCurrency(val, currency = userSettings.currency) { 
                return new Intl.NumberFormat('en-US', { style: 'currency', currency: currency }).format(val); 
            }
            function getFavorites() { return JSON.parse(localStorage.getItem('cryptoFavorites') || '[]'); }
            function saveFavorites(arr) { localStorage.setItem('cryptoFavorites', JSON.stringify(arr)); }
            function generateQrCode(text, containerId) { const container = document.getElementById(containerId); container.innerHTML = ''; const qr = qrcode(0, 'L'); qr.addData(text); qr.make(); container.innerHTML = qr.createImgTag(4); }
            function copyToClipboard(elementId) { const element = document.getElementById(elementId); if (!element) return; const textToCopy = element.textContent; const tempInput = document.createElement('textarea'); tempInput.value = textToCopy; document.body.appendChild(tempInput); tempInput.select(); try { document.execCommand('copy'); showNotification('Copied!', 'Card number copied to clipboard.'); } catch (err) { showNotification('Error', 'Failed to copy text.'); console.error('Fallback: Oops, unable to copy', err); } document.body.removeChild(tempInput); }

            /* ---------- DASHBOARD UPDATE LOGIC ---------- */
            function updateDashboard() {
                const totalCryptoBalance = cryptoData.reduce((acc, asset) => acc + (asset.balance * asset.price), 0);
                const totalFiatBalance = cardData.reduce((acc, card) => acc + card.balance, 0);
                const totalBalance = totalCryptoBalance + totalFiatBalance;
                
                document.getElementById('total-balance-value').dataset.usdValue = totalBalance;
                document.getElementById('crypto-balance-value').dataset.usdValue = totalCryptoBalance;
                document.getElementById('fiat-balance-value').dataset.usdValue = totalFiatBalance;
                document.getElementById('sidebar-crypto-balance').dataset.usdValue = totalCryptoBalance;
                document.getElementById('sidebar-fiat-balance').dataset.usdValue = totalFiatBalance;

                updateCurrencyDisplay();
                renderClientCards('cardStack');
                renderCardsPage();
                updateNotificationBadge();
                createCryptoTable('dashboard-crypto-table-container', 'dashboard-crypto-pagination', cryptoData);
                createTransactionTable('dashboard-transaction-table-container', 'dashboard-tx-pagination', transactionData.slice(0, 5));
                updateProfileDisplays();
            }
            
            function updateCurrencyDisplay() {
                const currency = userSettings.currency;
                const rate = exchangeRates[currency] || 1;
                document.querySelectorAll('[data-usd-value]').forEach(el => {
                    const usdValue = parseFloat(el.dataset.usdValue);
                    el.textContent = formatCurrency(usdValue * rate, currency);
                });
            }

            /* ---------- CARD STACK LOGIC ---------- */
            function renderClientCards(containerId) {
                const stackContainer = document.getElementById(containerId);
                if (!stackContainer) return;
                let cardsToDisplay = [...cardData];
                if (displaySettings.enableStackedView) { if (displaySettings.stackedCardCount !== 'all' && displaySettings.stackedCardIds.length > 0) { cardsToDisplay = cardData.filter(card => displaySettings.stackedCardIds.includes(card.id)); } } else { cardsToDisplay = cardData.length > 0 ? [cardData[0]] : []; }
                if (cardsToDisplay.length === 0) { stackContainer.innerHTML = '<p class="text-center text-gray-400">No cards available.</p>'; return; }
                stackContainer.innerHTML = cardsToDisplay.map((card, index) => {
                    const balanceDisplay = userSettings.showCardBalance ? `<div class="text-base font-bold" data-usd-value="${card.balance}">${formatCurrency(card.balance)}</div>` : `<div class="text-base font-bold">****</div>`;
                    return `<div class="virtual-card card-${card.type} ${card.isFrozen ? 'frozen' : ''}" style="z-index: ${cardsToDisplay.length - index}; transform: translateY(${index * 20}px) scale(${1 - index * 0.05});" data-id="${card.id}"><div class="virtual-card-pattern"></div><div class="flex justify-between items-start"><div class="text-lg font-semibold">${platformSettings.cardBrandName}</div><div class="text-lg font-semibold">${platformSettings.cardTypes[card.type].name}</div></div><div class="flex items-center gap-4"><div class="card-chip"><svg xmlns="http://www.w3.org/2000/svg" width="40" height="30" viewBox="0 0 40 30"><rect width="40" height="30" fill="#d4af37" rx="4"/><path d="M10 15h20M20 5v20M15 10h10M15 20h10" stroke="#a88823" stroke-width="1.5"/></svg></div><div class="text-lg font-mono tracking-widest">**** **** **** ${card.cardNumber.slice(-4)}</div></div><div class="flex justify-between items-end">${balanceDisplay}<i class="fab fa-cc-visa text-2xl italic"></i></div></div>`
                }).join('');
                updateCurrencyDisplay();
            }

            /* ---------- REUSABLE TABLE COMPONENTS ---------- */
            const PAGE_SIZE = 5;
            function createCryptoTable(containerId, paginationId, data) {
                const container = document.getElementById(containerId);
                container.innerHTML = `<div class="section-header"><i class="fas fa-chart-line"></i><span>Crypto Assets</span></div><div class="table-container"><div class="table-controls"><div class="search-box"><i class="fas fa-search search-icon"></i><input type="text" placeholder="Search assets..." class="search-input crypto-search-input"/></div><div class="table-tabs crypto-tabs"><div class="table-tab active" data-tab="all">All</div><div class="table-tab" data-tab="spot">Spot</div><div class="table-tab" data-tab="favorites">Favorites</div></div></div><div class="scrollable-table-wrapper"><table class="crypto-table"><thead><tr><th class="w-1/4 text-left">Asset</th><th class="w-1/6 text-left">Price</th><th class="w-1/6 text-left">24h</th><th class="w-1/6 text-left">Holdings (USD)</th><th class="w-1/6 text-left">Balance (Crypto)</th><th class="w-1/12 text-left">Favorite</th></tr></thead><tbody class="crypto-table-body"></tbody></table></div><div class="pagination-controls" id="${paginationId}"></div></div>`;
                let currentPage = 1, currentFilter = 'all', currentSearch = '';
                const searchInput = container.querySelector('.crypto-search-input'), tabs = container.querySelector('.crypto-tabs'), tbody = container.querySelector('.crypto-table-body'), pagination = document.getElementById(paginationId);
                function render() {
                    let filteredData = [...data];
                    if (currentSearch) { const s = currentSearch.toLowerCase(); filteredData = filteredData.filter(d => d.asset.toLowerCase().includes(s) || d.ticker.toLowerCase().includes(s)); }
                    if (currentFilter === 'favorites') { const fav = getFavorites(); filteredData = filteredData.filter(d => fav.includes(d.id)); }
                    if (currentFilter === 'spot') { filteredData = filteredData.filter(d => ['BTC', 'ETH', 'BNB', 'SOL'].includes(d.ticker)); }
                    const start = (currentPage - 1) * PAGE_SIZE, items = filteredData.slice(start, start + PAGE_SIZE), fav = getFavorites();
                    tbody.innerHTML = items.map(item => { const isFav = fav.includes(item.id); const holdingValue = item.balance * item.price; return `<tr data-id="${item.id}"><td><div class="asset"><img src="${item.icon}" class="asset-icon" onerror="this.src='https://placehold.co/24x24/1e1e26/f0f0f5?text=${item.ticker}'"/><div><span class="asset-name">${item.asset}</span> <span class="asset-ticker">${item.ticker}</span></div></div></td><td data-usd-value="${item.price}">${formatCurrency(item.price)}</td><td class="${item.change >= 0 ? 'positive' : 'negative'}">${item.change ? item.change.toFixed(2) : '0.00'}%</td><td data-usd-value="${holdingValue}">${formatCurrency(holdingValue)}</td><td>${item.balance} ${item.ticker}</td><td class="text-center"><i class="favorite-star ${isFav ? 'fas fa-star favorited' : 'far fa-star'}"></i></td></tr>`; }).join('');
                    updateCurrencyDisplay();
                    const pageCount = Math.ceil(filteredData.length / PAGE_SIZE);
                    pagination.innerHTML = '';
                    if (pageCount > 1) {
                        const prevBtn = document.createElement('button'); prevBtn.textContent = 'Previous'; prevBtn.classList.add('pagination-button'); prevBtn.disabled = currentPage === 1; prevBtn.onclick = () => { if (currentPage > 1) { currentPage--; render(); } }; pagination.appendChild(prevBtn);
                        for (let i = 1; i <= pageCount; i++) { const btn = document.createElement('button'); btn.textContent = i; btn.className = 'pagination-button' + (i === currentPage ? ' active' : ''); btn.onclick = () => { currentPage = i; render(); }; pagination.appendChild(btn); }
                        const nextBtn = document.createElement('button'); nextBtn.textContent = 'Next'; nextBtn.classList.add('pagination-button'); nextBtn.disabled = currentPage === pageCount; nextBtn.onclick = () => { if (currentPage < pageCount) { currentPage++; render(); } }; pagination.appendChild(nextBtn);
                    }
                }
                searchInput.addEventListener('input', e => { currentSearch = e.target.value; currentPage = 1; render(); });
                tabs.addEventListener('click', e => { if (e.target.classList.contains('table-tab')) { tabs.querySelector('.active').classList.remove('active'); e.target.classList.add('active'); currentFilter = e.target.dataset.tab; currentPage = 1; render(); } });
                tbody.addEventListener('click', e => { const star = e.target.closest('.favorite-star'); if (!star) return; const id = star.closest('tr').dataset.id; let fav = getFavorites(); if (fav.includes(id)) { fav = fav.filter(i => i !== id); } else { fav.push(id); } saveFavorites(fav); render(); });
                render();
            }

            function createTransactionTable(containerId, paginationId, data) {
                const container = document.getElementById(containerId);
                container.innerHTML = `<div class="section-header"><i class="fas fa-history"></i><span>Transaction History</span></div><div class="table-container"><div class="scrollable-table-wrapper"><table class="transaction-table"><thead><tr><th>ID</th><th>Date</th><th>Asset</th><th>Type</th><th>Amount</th><th>Fee</th><th>Status</th></tr></thead><tbody class="transaction-table-body"></tbody></table></div><div class="pagination-controls" id="${paginationId}"></div></div>`;
                let currentPage = 1;
                const tbody = container.querySelector('.transaction-table-body'), pagination = document.getElementById(paginationId);
                function render() {
                    const start = (currentPage - 1) * PAGE_SIZE, items = data.slice(start, start + PAGE_SIZE);
                    tbody.innerHTML = items.map(item => `<tr><td>${item.id}</td><td>${item.date.toLocaleString(undefined, { timeZone: userSettings.timezone })}</td><td><div class="asset"><img src="${item.icon}" class="asset-icon"/><span>${item.asset}</span></div></td><td>${item.type}</td><td>${item.amount}</td><td>${item.fee}</td><td class="status-${item.status.toLowerCase()}">${item.status}</td></tr>`).join('');
                    const pageCount = Math.ceil(data.length / PAGE_SIZE); pagination.innerHTML = ''; if (pageCount > 1) { /* Pagination logic here if needed */ }
                }
                render();
            }

            /* ---------- DEPOSIT/WITHDRAWAL LOGIC ---------- */
            let currentAddressIndex = 0;
            function setupDepositModal() {
                const assetSelect = document.getElementById('deposit-asset-select');
                assetSelect.innerHTML = cryptoData.map(c => `<option value="${c.id}">${c.asset}</option>`).join('');
                function updateDepositInfo() { const assetId = assetSelect.value, asset = cryptoData.find(c => c.id === assetId); if (!asset) return; const address = asset.addresses[currentAddressIndex]; document.getElementById('deposit-address').value = address; generateQrCode(address, 'deposit-qr-code'); }
                assetSelect.addEventListener('change', () => { currentAddressIndex = 0; updateDepositInfo(); });
                document.getElementById('generate-address-btn').addEventListener('click', () => { const assetId = assetSelect.value, asset = cryptoData.find(c => c.id === assetId); if (!asset) return; currentAddressIndex = (currentAddressIndex + 1) % asset.addresses.length; updateDepositInfo(); });
                updateDepositInfo();
            }
            function setupWithdrawalModal() { document.getElementById('withdraw-asset-select').innerHTML = cryptoData.map(c => `<option value="${c.id}">${c.asset}</option>`).join(''); }
            document.getElementById('withdraw-form').addEventListener('submit', e => { e.preventDefault(); const assetId = document.getElementById('withdraw-asset-select').value, asset = cryptoData.find(c => c.id === assetId), amount = parseFloat(document.getElementById('withdraw-amount').value); if (amount > asset.balance) { showNotification('Error', 'Insufficient balance for this withdrawal.'); return; } showNotification('Success', 'Withdrawal request submitted.'); document.getElementById('withdraw-modal').classList.remove('active'); updateDashboard(); });

            /* ---------- CARD MANAGEMENT LOGIC ---------- */
            function openSetPinModal(card, isAdmin = false) { document.getElementById('set-pin-card-id').value = card.id; document.getElementById('pin-card-number').textContent = `**** ${card.cardNumber.slice(-4)}`; document.getElementById('confirm-pin-group').style.display = isAdmin ? 'none' : 'block'; document.getElementById('set-pin-modal').classList.add('active'); }
            function handleSetPinSubmit(e) { e.preventDefault(); const cardId = document.getElementById('set-pin-card-id').value, newPin = document.getElementById('new-pin').value, confirmPin = document.getElementById('confirm-pin').value, card = cardData.find(c => c.id === cardId), isAdmin = document.getElementById('confirm-pin-group').style.display === 'none'; if (card) { if (!isAdmin && newPin !== confirmPin) { showNotification('Error', 'PINs do not match.'); return; } card.pin = newPin; showNotification('Success', 'Card PIN updated successfully.'); document.getElementById('set-pin-modal').classList.remove('active'); e.target.reset(); updateDashboard(); } }
            document.getElementById('set-pin-form').addEventListener('submit', handleSetPinSubmit);
            
            /* ---------- PLATFORM DESIGN LOGIC ---------- */
            function applyPlatformDesign() { const { appName, logoInitials, logoColor, bgColor, fontColor, btnColor, cardColor } = platformSettings; document.getElementById('logo-text').textContent = appName; document.getElementById('logo-img').textContent = logoInitials; document.getElementById('dynamic-styles').innerHTML = `:root { --bg-dark: ${bgColor}; --bg-dark-gray: ${bgColor}; --accent-yellow: ${logoColor}; --font-color-primary: ${fontColor}; --button-color: ${btnColor}; --card-color: ${cardColor}; --highlight: ${logoColor}1A; --bg-gray:#1e1e26; --border:#2a2a34; --text-primary:${fontColor}; --text-secondary:#a0a0b0; --text-tertiary:#6a6a7a; --accent-green:#20e6a0; --accent-red:#ff5a5a; --accent-blue: ${btnColor}; }`; renderClientCards('cardStack'); }

            /* ---------- PAGE-SPECIFIC RENDER FUNCTIONS ---------- */
            function renderCryptoAssetsPage() { createCryptoTable('crypto-assets-page-table-container', 'crypto-assets-page-pagination', cryptoData); createTransactionTable('crypto-assets-page-tx-table-container', 'crypto-assets-page-tx-pagination', transactionData); const totalCryptoBalance = cryptoData.reduce((acc, asset) => acc + (asset.balance * asset.price), 0), totalFiatBalance = cardData.reduce((acc, card) => acc + card.balance, 0); document.getElementById('crypto-page-crypto-balance').dataset.usdValue = totalCryptoBalance; document.getElementById('crypto-page-fiat-balance').dataset.usdValue = totalFiatBalance; updateCurrencyDisplay(); const assetSelect = document.getElementById('crypto-page-asset-select'), fromSelect = document.getElementById('convert-from-asset'), toSelect = document.getElementById('convert-to-asset'), options = cryptoData.map(c => `<option value="${c.id}">${c.asset}</option>`).join(''); assetSelect.innerHTML = options; fromSelect.innerHTML = options; toSelect.innerHTML = options; }
            function renderTransactionsPage() { document.getElementById('tx-filter-asset').innerHTML = '<option value="all">All Assets</option>' + cryptoData.map(c => `<option value="${c.asset}">${c.asset}</option>`).join(''); flatpickr("#tx-filter-date", { mode: "range", dateFormat: "Y-m-d", }); document.getElementById('tx-filter-apply').addEventListener('click', () => { const type = document.getElementById('tx-filter-type').value, asset = document.getElementById('tx-filter-asset').value, dateRange = document.getElementById('tx-filter-date').value; let filteredData = [...transactionData]; if (type !== 'all') filteredData = filteredData.filter(tx => tx.type === type); if (asset !== 'all') filteredData = filteredData.filter(tx => tx.asset === asset); if (dateRange) { const [start, end] = dateRange.split(' to ').map(d => new Date(d)); if(end) { filteredData = filteredData.filter(tx => tx.date >= start && tx.date <= end); } else { filteredData = filteredData.filter(tx => tx.date.toDateString() === start.toDateString()); } } createTransactionTable('transactions-page-table-container', 'transactions-page-pagination', filteredData); }); createTransactionTable('transactions-page-table-container', 'transactions-page-pagination', transactionData); }
            function renderWithdrawalsPage() { createTransactionTable('withdrawals-page-tx-table-container', 'withdrawals-page-tx-pagination', transactionData); }
            
            function renderNotificationsPage() {
                const listContainer = document.getElementById('notifications-list-container');
                 const sortedNotifications = [...notificationsData].sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
                listContainer.innerHTML = sortedNotifications.map(n => `
                    <div class="notification-item">
                        <i class="fas fa-info-circle notification-icon"></i>
                        <div class="notification-content">
                            <p class="notification-message">${n.message}</p>
                            <span class="notification-time">${new Date(n.timestamp).toLocaleString(undefined, { timeZone: userSettings.timezone })}</span>
                        </div>
                    </div>
                `).join('') || '<p class="p-4 text-sm text-center text-gray-400">No new notifications.</p>';
            }

             function handleMarkAllRead() {
                notificationsData.forEach(n => n.read = true);
                updateNotificationBadge();
                renderHeaderNotificationList();
                if (document.getElementById('notifications-page').classList.contains('active')) {
                    renderNotificationsPage();
                }
                showNotification('Success', 'All notifications marked as read.');
            }

            document.getElementById('mark-all-read-btn').addEventListener('click', handleMarkAllRead);
            document.getElementById('modal-mark-all-read-btn').addEventListener('click', handleMarkAllRead);


            /* ---------- CARDS PAGE LOGIC ---------- */
            function renderCardsPage() { document.getElementById('total-cards-page').textContent = cardData.length; document.getElementById('active-cards-page').textContent = cardData.filter(c => c.status === 'active' && !c.isFrozen).length; document.getElementById('pending-cards-page').textContent = cardData.filter(c => c.physicalCardStatus === 'requested').length; document.getElementById('inactive-cards-page').textContent = cardData.filter(c => c.status !== 'active' || c.isFrozen).length; let cardsForList = cardData; if (displaySettings.enableStackedView && displaySettings.stackedCardCount !== 'all' && displaySettings.stackedCardIds.length > 0) { cardsForList = cardData.filter(card => displaySettings.stackedCardIds.includes(card.id)); } document.getElementById('all-cards-count').textContent = cardsForList.length; renderClientCards('cardStackPage'); const list = document.getElementById('all-cards-list'); list.innerHTML = ''; const topCardId = cardData.length > 0 ? cardData[0].id : null; cardsForList.forEach(c => { const div = document.createElement('div'); div.className = `p-4 rounded-lg border-2 transition-colors hover:bg-gray-800 cursor-pointer ${topCardId === c.id ? 'border-accent-yellow' : 'border-gray-700'}`; div.dataset.id = c.id; const balanceDisplay = userSettings.showCardBalance ? `<div class="font-bold" data-usd-value="${c.balance}">${formatCurrency(c.balance)}</div>` : `<div class="font-bold">****</div>`; div.innerHTML = `<div class="flex justify-between items-center"><div class="flex items-center gap-4 min-w-0"><div class="w-12 h-8 rounded-md flex items-center justify-center bg-gray-900 card-${c.type}"><i class="fas fa-credit-card text-lg"></i></div><div><div class="font-mono text-base break-words">**** ${c.cardNumber.slice(-4)}</div><div class="text-sm text-gray-400">${c.cardholderName}</div></div></div><div class="text-right">${balanceDisplay}<div class="status-badge ${c.isFrozen ? 'frozen' : c.status}">${c.isFrozen ? 'Frozen' : c.status}</div></div></div>`; div.onclick = () => { const cardId = c.id; const cardIndex = cardData.findIndex(card => card.id === cardId); if (cardIndex > -1) { const [clickedCard] = cardData.splice(cardIndex, 1); cardData.unshift(clickedCard); updateDashboard(); } }; list.appendChild(div); }); updateCurrencyDisplay(); }
            function setupCardsPage() { const showDetails = () => { if (!cardData.length) { showNotification('No Cards', 'There are no cards to show details for.'); return; } const card = cardData[0]; document.getElementById('cd-full-number').textContent = card.cardNumber.replace(/(.{4})/g, '$1 ').trim(); document.getElementById('cd-tier').textContent = card.type; document.getElementById('cd-physical-status').textContent = card.physicalCardStatus === 'none' ? 'Virtual' : 'Physical'; document.getElementById('cd-limits').textContent = `Daily: ${formatCurrency(card.limits.daily)} / Monthly: ${formatCurrency(card.limits.monthly)}`; const statusBadge = document.getElementById('cd-status'); statusBadge.className = `status-badge ${card.isFrozen ? 'frozen' : card.status}`; statusBadge.textContent = card.isFrozen ? 'Frozen' : card.status; const front = document.getElementById('details-card-front'), back = document.getElementById('details-card-back'); front.className = `virtual-card-front p-5 card-${card.type}`; back.className = `virtual-card-back p-5 card-${card.type}`; front.innerHTML = `<div class="virtual-card-pattern"></div><div class="flex justify-between items-center"><span class="text-lg font-bold">${platformSettings.cardBrandName}</span><span class="font-semibold capitalize">${card.type}</span></div><div><div class="text-xl font-mono tracking-widest">${card.cardNumber.replace(/(.{4})/g, '$1 ').trim()}</div></div><div class="flex justify-between text-xs uppercase"><span >${card.cardholderName}</span><span>${card.expiry}</span></div>`; back.innerHTML = `<div class="virtual-card-pattern"></div><div class="mag-stripe"></div><div class="text-right text-xs mt-2"><div class="mb-2">For customer service, call 1-800-123-4567</div><div class="signature-strip relative"><span class="text-xs font-mono">${card.cvv}</span></div></div><div class="text-right text-xs uppercase">${card.cardholderName}</div>`; document.getElementById('card-details-modal').classList.add('active'); }; document.getElementById('showDetailsBtn').onclick = showDetails; document.getElementById('cards-page-deposit-btn').onclick = showDetails; document.getElementById('freezeCardBtn').onclick = () => { if (!cardData.length) return; const card = cardData[0]; card.isFrozen = !card.isFrozen; showNotification('Success', `Card ending in ${card.cardNumber.slice(-4)} has been ${card.isFrozen ? 'frozen' : 'unfrozen'}.`); updateDashboard(); }; document.getElementById('setPinBtn').onclick = () => { if (!cardData.length) return; const card = cardData[0]; openSetPinModal(card, false); }; document.getElementById('viewLimitsBtn').onclick = () => { if (!cardData.length) return; const card = cardData[0]; const content = document.getElementById('card-limits-content'); content.innerHTML = `<p class="mb-2"><strong>Daily Limit:</strong> ${formatCurrency(card.limits.daily)}</p><p class="mb-2"><strong>Monthly Limit:</strong> ${formatCurrency(card.limits.monthly)}</p><p><strong>Contactless Limit:</strong> ${formatCurrency(card.limits.contactless)}</p>`; document.getElementById('card-limits-modal').classList.add('active'); }; document.getElementById('cards-page-withdraw-btn').onclick = () => showPage('withdrawals'); }

            /* ---------- NOTIFICATIONS ---------- */
            function renderHeaderNotificationList() {
                const listContainer = document.getElementById('header-notification-list');
                const sortedNotifications = [...notificationsData].sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
                listContainer.innerHTML = sortedNotifications.map(n => `
                    <div class="notification-item ${n.read ? 'opacity-60' : ''}">
                        <i class="fas fa-info-circle notification-icon"></i>
                        <div class="notification-content">
                            <p class="notification-message">${n.message}</p>
                            <span class="notification-time">${new Date(n.timestamp).toLocaleString(undefined, { timeZone: userSettings.timezone })}</span>
                        </div>
                    </div>
                `).join('') || '<p class="p-4 text-sm text-center text-gray-400">No new notifications.</p>';
            }
            function updateNotificationBadge() {
                const unreadCount = notificationsData.filter(n => !n.read).length;
                const badge = document.getElementById('notification-badge');
                badge.textContent = unreadCount;
                badge.style.display = unreadCount > 0 ? 'flex' : 'none';
            }
            
            /* ---------- HEADER & USER DROPDOWN ---------- */
            function setupHeader() {
                const userMenuButton = document.getElementById('user-menu-button');
                const userDropdown = document.getElementById('user-dropdown');
                const notificationBell = document.getElementById('notification-bell');
                const notificationDropdown = document.getElementById('notification-dropdown');

                userMenuButton.addEventListener('click', (e) => {
                    e.stopPropagation();
                    userDropdown.classList.toggle('hidden');
                    notificationDropdown.classList.add('hidden');
                });
                
                notificationBell.addEventListener('click', (e) => {
                    e.stopPropagation();
                    notificationDropdown.classList.toggle('hidden');
                    userDropdown.classList.add('hidden');
                    if (!notificationDropdown.classList.contains('hidden')) {
                        renderHeaderNotificationList();
                    }
                });

                document.getElementById('view-all-notifications-link').addEventListener('click', (e) => {
                    e.preventDefault();
                    notificationDropdown.classList.add('hidden');
                    showPage('notifications');
                });

                document.addEventListener('click', (e) => {
                    if (!userMenuButton.contains(e.target)) userDropdown.classList.add('hidden');
                    if (!notificationBell.contains(e.target)) notificationDropdown.classList.add('hidden');
                });
            }
            
            /* ---------- ASSET CONVERSION ---------- */
            function setupAssetConversion() { const fromSelect = document.getElementById('convert-from-asset'), toSelect = document.getElementById('convert-to-asset'), amountInput = document.getElementById('convert-amount'), resultDiv = document.getElementById('conversion-result'), convertBtn = document.getElementById('convert-btn'); function calculateConversion() { const fromAssetId = fromSelect.value, toAssetId = toSelect.value, amount = parseFloat(amountInput.value), fromAsset = cryptoData.find(c => c.id === fromAssetId), toAsset = cryptoData.find(c => c.id === toAssetId); if (fromAsset && toAsset && amount > 0 && fromAsset.price > 0 && toAsset.price > 0) { const convertedAmount = (amount * fromAsset.price) / toAsset.price; resultDiv.textContent = `â‰ˆ ${convertedAmount.toFixed(6)} ${toAsset.ticker}`; } else { resultDiv.textContent = ''; } } [fromSelect, toSelect, amountInput].forEach(el => { el.addEventListener('input', calculateConversion); el.addEventListener('change', calculateConversion); }); convertBtn.addEventListener('click', () => { const fromAssetId = fromSelect.value, toAssetId = toSelect.value, amount = parseFloat(amountInput.value), fromAsset = cryptoData.find(c => c.id === fromAssetId), toAsset = cryptoData.find(c => c.id === toAssetId); if (!fromAsset || !toAsset || !(amount > 0)) { showNotification('Error', 'Please select assets and enter a valid amount.'); return; } if (amount > fromAsset.balance) { showNotification('Error', 'Insufficient balance for conversion.'); return; } const convertedAmount = (amount * fromAsset.price) / toAsset.price; fromAsset.balance -= amount; toAsset.balance += convertedAmount; showNotification('Success', `Converted ${amount} ${fromAsset.ticker} to ${convertedAmount.toFixed(6)} ${toAsset.ticker}.`); updateDashboard(); amountInput.value = ''; resultDiv.textContent = ''; }); }

            /* ---------- COUNTRY LIST & KYC MODAL ---------- */
            const countries = [ {code: "AF", name: "Afghanistan"}, {code: "AL", name: "Albania"}, {code: "DZ", name: "Algeria"}, {code: "AD", name: "Andorra"}, {code: "AO", name: "Angola"}, {code: "AG", name: "Antigua and Barbuda"}, {code: "AR", name: "Argentina"}, {code: "AM", name: "Armenia"}, {code: "AU", name: "Australia"}, {code: "AT", name: "Austria"}, {code: "AZ", name: "Azerbaijan"}, {code: "BS", name: "Bahamas"}, {code: "BH", name: "Bahrain"}, {code: "BD", name: "Bangladesh"}, {code: "BB", name: "Barbados"}, {code: "BY", name: "Belarus"}, {code: "BE", name: "Belgium"}, {code: "BZ", name: "Belize"}, {code: "BJ", name: "Benin"}, {code: "BT", name: "Bhutan"}, {code: "BO", name: "Bolivia"}, {code: "BA", name: "Bosnia and Herzegovina"}, {code: "BW", name: "Botswana"}, {code: "BR", name: "Brazil"}, {code: "BN", name: "Brunei"}, {code: "BG", name: "Bulgaria"}, {code: "BF", name: "Burkina Faso"}, {code: "BI", name: "Burundi"}, {code: "CV", name: "Cabo Verde"}, {code: "KH", name: "Cambodia"}, {code: "CM", name: "Cameroon"}, {code: "CA", name: "Canada"}, {code: "CF", name: "Central African Republic"}, {code: "TD", name: "Chad"}, {code: "CL", name: "Chile"}, {code: "CN", name: "China"}, {code: "CO", name: "Colombia"}, {code: "KM", name: "Comoros"}, {code: "CG", name: "Congo"}, {code: "CR", name: "Costa Rica"}, {code: "HR", name: "Croatia"}, {code: "CU", name: "Cuba"}, {code: "CY", name: "Cyprus"}, {code: "CZ", name: "Czech Republic"}, {code: "DK", name: "Denmark"}, {code: "DJ", name: "Djibouti"}, {code: "DM", name: "Dominica"}, {code: "DO", name: "Dominican Republic"}, {code: "EC", name: "Ecuador"}, {code: "EG", name: "Egypt"}, {code: "SV", name: "El Salvador"}, {code: "GQ", name: "Equatorial Guinea"}, {code: "ER", name: "Eritrea"}, {code: "EE", name: "Estonia"}, {code: "SZ", name: "Eswatini"}, {code: "ET", name: "Ethiopia"}, {code: "FJ", name: "Fiji"}, {code: "FI", name: "Finland"}, {code: "FR", name: "France"}, {code: "GA", name: "Gabon"}, {code: "GM", name: "Gambia"}, {code: "GE", name: "Georgia"}, {code: "DE", name: "Germany"}, {code: "GH", name: "Ghana"}, {code: "GR", name: "Greece"}, {code: "GD", name: "Grenada"}, {code: "GT", name: "Guatemala"}, {code: "GN", name: "Guinea"}, {code: "GW", name: "Guinea-Bissau"}, {code: "GY", name: "Guyana"}, {code: "HT", name: "Haiti"}, {code: "HN", name: "Honduras"}, {code: "HU", name: "Hungary"}, {code: "IS", name: "Iceland"}, {code: "IN", name: "India"}, {code: "ID", name: "Indonesia"}, {code: "IR", name: "Iran"}, {code: "IQ", name: "Iraq"}, {code: "IE", name: "Ireland"}, {code: "IL", name: "Israel"}, {code: "IT", name: "Italy"}, {code: "JM", name: "Jamaica"}, {code: "JP", name: "Japan"}, {code: "JO", name: "Jordan"}, {code: "KZ", name: "Kazakhstan"}, {code: "KE", name: "Kenya"}, {code: "KI", name: "Kiribati"}, {code: "KP", name: "North Korea"}, {code: "KR", name: "South Korea"}, {code: "KW", name: "Kuwait"}, {code: "KG", name: "Kyrgyzstan"}, {code: "LA", name: "Laos"}, {code: "LV", name: "Latvia"}, {code: "LB", name: "Lebanon"}, {code: "LS", name: "Lesotho"}, {code: "LR", name: "Liberia"}, {code: "LY", name: "Libya"}, {code: "LI", name: "Liechtenstein"}, {code: "LT", name: "Lithuania"}, {code: "LU", name: "Luxembourg"}, {code: "MG", name: "Madagascar"}, {code: "MW", name: "Malawi"}, {code: "MY", name: "Malaysia"}, {code: "MV", name: "Maldives"}, {code: "ML", name: "Mali"}, {code: "MT", name: "Malta"}, {code: "MH", name: "Marshall Islands"}, {code: "MR", name: "Mauritania"}, {code: "MU", name: "Mauritius"}, {code: "MX", name: "Mexico"}, {code: "FM", name: "Micronesia"}, {code: "MD", name: "Moldova"}, {code: "MC", name: "Monaco"}, {code: "MN", name: "Mongolia"}, {code: "ME", name: "Montenegro"}, {code: "MA", name: "Morocco"}, {code: "MZ", name: "Mozambique"}, {code: "MM", name: "Myanmar"}, {code: "NA", name: "Namibia"}, {code: "NR", name: "Nauru"}, {code: "NP", name: "Nepal"}, {code: "NL", name: "Netherlands"}, {code: "NZ", name: "New Zealand"}, {code: "NI", name: "Nicaragua"}, {code: "NE", name: "Niger"}, {code: "NG", name: "Nigeria"}, {code: "MK", name: "North Macedonia"}, {code: "NO", name: "Norway"}, {code: "OM", name: "Oman"}, {code: "PK", name: "Pakistan"}, {code: "PW", name: "Palau"}, {code: "PS", name: "Palestine"}, {code: "PA", name: "Panama"}, {code: "PG", name: "Papua New Guinea"}, {code: "PY", name: "Paraguay"}, {code: "PE", name: "Peru"}, {code: "PH", name: "Philippines"}, {code: "PL", name: "Poland"}, {code: "PT", name: "Portugal"}, {code: "QA", name: "Qatar"}, {code: "RO", name: "Romania"}, {code: "RU", name: "Russia"}, {code: "RW", name: "Rwanda"}, {code: "KN", name: "Saint Kitts and Nevis"}, {code: "LC", name: "Saint Lucia"}, {code: "VC", name: "Saint Vincent and the Grenadines"}, {code: "WS", name: "Samoa"}, {code: "SM", name: "San Marino"}, {code: "ST", name: "Sao Tome and Principe"}, {code: "SA", name: "Saudi Arabia"}, {code: "SN", name: "Senegal"}, {code: "RS", name: "Serbia"}, {code: "SC", name: "Seychelles"}, {code: "SL", name: "Sierra Leone"}, {code: "SG", name: "Singapore"}, {code: "SK", name: "Slovakia"}, {code: "SI", name: "Slovenia"}, {code: "SB", name: "Solomon Islands"}, {code: "SO", name: "Somalia"}, {code: "ZA", name: "South Africa"}, {code: "SS", name: "South Sudan"}, {code: "ES", name: "Spain"}, {code: "LK", name: "Sri Lanka"}, {code: "SD", name: "Sudan"}, {code: "SR", name: "Suriname"}, {code: "SE", name: "Sweden"}, {code: "CH", name: "Switzerland"}, {code: "SY", name: "Syria"}, {code: "TW", name: "Taiwan"}, {code: "TJ", name: "Tajikistan"}, {code: "TZ", name: "Tanzania"}, {code: "TH", name: "Thailand"}, {code: "TL", name: "Timor-Leste"}, {code: "TG", name: "Togo"}, {code: "TO", name: "Tonga"}, {code: "TT", name: "Trinidad and Tobago"}, {code: "TN", name: "Tunisia"}, {code: "TR", name: "Turkey"}, {code: "TM", name: "Turkmenistan"}, {code: "TV", name: "Tuvalu"}, {code: "UG", name: "Uganda"}, {code: "UA", name: "Ukraine"}, {code: "AE", name: "United Arab Emirates"}, {code: "GB", name: "United Kingdom"}, {code: "US", name: "United States"}, {code: "UY", name: "Uruguay"}, {code: "UZ", name: "Uzbekistan"}, {code: "VU", name: "Vanuatu"}, {code: "VA", name: "Vatican City"}, {code: "VE", name: "Venezuela"}, {code: "VN", name: "Vietnam"}, {code: "YE", name: "Yemen"}, {code: "ZM", name: "Zambia"}, {code: "ZW", name: "Zimbabwe"} ];
            function populateCountryDropdowns() { const nationalitySelect = document.getElementById('nationality-select'), countrySelect = document.getElementById('country-select'), countryOptions = countries.map(country => `<option value="${country.code}">${country.name}</option>`).join(''); nationalitySelect.innerHTML = '<option value="">Select your nationality</option>' + countryOptions; countrySelect.innerHTML = '<option value="">Select your country</option>' + countryOptions; }
            function initKYCModal() { const steps = document.querySelectorAll('.kyc-step'), circles = document.querySelectorAll('.progress-circle'), nextBtn = document.querySelector('.kyc-next'), prevBtn = document.querySelector('.kyc-prev'); let currentStep = 1; const totalSteps = steps.length; function updateButtons() { if (currentStep === 1) { prevBtn.classList.add('hidden'); } else { prevBtn.classList.remove('hidden'); } if (currentStep === totalSteps) { nextBtn.innerHTML = 'Submit <i class="fas fa-check ml-2"></i>'; } else { nextBtn.innerHTML = 'Next <i class="fas fa-arrow-right ml-2"></i>'; } } function updateSteps() { steps.forEach((step, idx) => { step.classList.toggle('active', idx + 1 === currentStep); step.classList.toggle('hidden', idx + 1 !== currentStep); }); circles.forEach((circle, idx) => { if (idx + 1 <= currentStep) { circle.classList.add('active'); } else { circle.classList.remove('active'); } }); } nextBtn.addEventListener('click', () => { if (currentStep < totalSteps) { currentStep++; updateSteps(); updateButtons(); } else { console.log('KYC data submitted'); document.getElementById('kyc-modal').classList.remove('active'); } }); prevBtn.addEventListener('click', () => { if (currentStep > 1) { currentStep--; updateSteps(); updateButtons(); } }); const dropZones = document.querySelectorAll('.border-dashed'); dropZones.forEach(zone => { zone.addEventListener('dragover', (e) => { e.preventDefault(); zone.style.borderColor = 'var(--accent-yellow)'; zone.style.backgroundColor = 'var(--highlight)'; }); zone.addEventListener('dragleave', () => { zone.style.borderColor = ''; zone.style.backgroundColor = ''; }); zone.addEventListener('drop', (e) => { e.preventDefault(); zone.style.borderColor = ''; zone.style.backgroundColor = ''; const files = Array.from(e.dataTransfer.files); if (files.length > 0) { console.log('Files dropped:', files); const fileName = document.createElement('div'); fileName.className = 'text-sm text-accent-yellow mt-2'; fileName.innerHTML = `<i class="fas fa-file mr-2"></i>${files[0].name}`; zone.appendChild(fileName); } }); zone.addEventListener('click', () => { const input = document.createElement('input'); input.type = 'file'; input.accept = 'image/*'; input.style.display = 'none'; input.onchange = (e) => { const file = e.target.files[0]; if (file) { console.log('File selected:', file); const fileName = document.createElement('div'); fileName.className = 'text-sm text-accent-yellow mt-2'; fileName.innerHTML = `<i class="fas fa-file mr-2"></i>${file.name}`; zone.appendChild(fileName); } }; document.body.appendChild(input); input.click(); document.body.removeChild(input); }); }); }
            
            /* ---------- SETTINGS & LOCALIZATION ---------- */
            function setupSettings() {
                // Timezones
                const timezones = Intl.supportedValuesOf('timeZone');
                const timezoneSelect = document.getElementById('timezone-select');
                timezoneSelect.innerHTML = timezones.map(tz => `<option value="${tz}" ${tz === userSettings.timezone ? 'selected' : ''}>${tz}</option>`).join('');
                timezoneSelect.addEventListener('change', (e) => {
                    userSettings.timezone = e.target.value;
                    updateDashboard(); 
                });
                
                // Currency
                document.getElementById('currency-select').addEventListener('change', (e) => {
                    userSettings.currency = e.target.value;
                    updateCurrencyDisplay();
                });

                // Balance Display Toggle
                const balanceToggle = document.getElementById('balance-display-toggle');
                balanceToggle.checked = userSettings.showCardBalance;
                balanceToggle.addEventListener('change', (e) => {
                    userSettings.showCardBalance = e.target.checked;
                    renderCardsPage();
                    showNotification('Settings Updated', `Card balance display is now ${e.target.checked ? 'ON' : 'OFF'}.`);
                });

                // Online Status Toggle
                const onlineToggle = document.getElementById('activity-status-toggle');
                const onlineBadge = document.getElementById('online-badge');
                onlineToggle.checked = userSettings.onlineStatus;
                onlineBadge.classList.toggle('hidden', !userSettings.onlineStatus);
                onlineToggle.addEventListener('change', (e) => {
                    userSettings.onlineStatus = e.target.checked;
                    onlineBadge.classList.toggle('hidden', !e.target.checked);
                    showNotification('Settings Updated', `Online status is now ${e.target.checked ? 'Visible' : 'Hidden'}.`);
                });
                
                // Security Alerts
                document.getElementById('security-alerts-toggle').addEventListener('change', e => {
                    showNotification('Security Settings', `Security alerts have been ${e.target.checked ? 'enabled' : 'disabled'}.`);
                });

                // Price Alerts
                const priceAlertToggle = document.getElementById('price-alerts-toggle');
                const priceAlertSelector = document.getElementById('price-alert-asset-selector');
                const priceAlertAsset = document.getElementById('price-alert-asset');
                
                priceAlertAsset.innerHTML = cryptoData.map(c => `<option value="${c.id}">${c.asset}</option>`).join('');

                priceAlertToggle.addEventListener('change', e => {
                    userSettings.priceAlert.enabled = e.target.checked;
                    priceAlertSelector.classList.toggle('hidden', !e.target.checked);
                    if(e.target.checked) {
                        const selectedAsset = cryptoData.find(c => c.id === priceAlertAsset.value);
                        userSettings.priceAlert.assetId = selectedAsset.id;
                        userSettings.priceAlert.lastPrice = selectedAsset.price;
                        showNotification('Price Alerts', `Alerts enabled for ${selectedAsset.asset}.`);
                    } else {
                        userSettings.priceAlert.assetId = null;
                        showNotification('Price Alerts', `Price alerts disabled.`);
                    }
                });
                priceAlertAsset.addEventListener('change', e => {
                    const selectedAsset = cryptoData.find(c => c.id === e.target.value);
                    userSettings.priceAlert.assetId = selectedAsset.id;
                    userSettings.priceAlert.lastPrice = selectedAsset.price;
                    showNotification('Price Alerts', `Now monitoring ${selectedAsset.asset}.`);
                });
            }

            /* ---------- PROFILE MANAGEMENT ---------- */
            function updateProfileDisplays() {
                const initials = userProfile.name.split(' ').map(n => n[0]).join('');
                // Header
                document.getElementById('header-user-name').textContent = userProfile.name;
                document.getElementById('header-user-email').textContent = userProfile.email;
                document.getElementById('header-avatar').textContent = initials;
                // Dropdown
                document.getElementById('dropdown-user-name').textContent = userProfile.name;
                document.getElementById('dropdown-user-email').textContent = userProfile.email;
                // Profile Page
                document.getElementById('profile-full-name').textContent = userProfile.name;
                document.getElementById('profile-display-name').textContent = userProfile.name;
                document.getElementById('profile-display-email').textContent = userProfile.email;
                document.getElementById('profile-avatar-initials').textContent = initials;
            }

            document.getElementById('change-name-form').addEventListener('submit', (e) => {
                e.preventDefault();
                const newName = document.getElementById('new-full-name').value;
                if(newName.trim()) {
                    userProfile.name = newName;
                    updateProfileDisplays();
                    document.getElementById('change-name-modal').classList.remove('active');
                    showNotification('Success', 'Your name has been updated.');
                }
            });

            document.getElementById('change-email-form').addEventListener('submit', (e) => {
                e.preventDefault();
                const newEmail = document.getElementById('new-email').value;
                if(newEmail.trim()) {
                    userProfile.email = newEmail;
                    updateProfileDisplays();
                    document.getElementById('change-email-modal').classList.remove('active');
                    showNotification('Success', 'Your email has been updated.');
                }
            });

            // Initializing all dashboard functionality
            initKYCModal();
            populateCountryDropdowns();
            setupModals();
            setupDepositModal();
            setupWithdrawalModal();
            setupCardsPage();
            applyPlatformDesign();
            setupHeader();
            setupAssetConversion();
            setupSettings();
            updateDashboard();
            
            document.querySelector('.app-container').addEventListener('click', (e) => {
                const cardStack = e.target.closest('#cardStack, #cardStackPage');
                if (cardStack && cardData.length > 1) {
                    const topCard = cardData.shift();
                    cardData.push(topCard);
                    updateDashboard();
                }
            });
        }

        /* ---------- APP INITIALIZATION ---------- */
        document.addEventListener('DOMContentLoaded', () => {
            initAppSwitcher();
            initLandingPage();
            initDashboard(); 
        });
        /* ---------- PASSWORD CHANGE LOGIC ---------- */
        document.addEventListener('DOMContentLoaded', function() {
            // Password visibility toggle
            document.querySelectorAll('.password-toggle').forEach(button => {
                button.addEventListener('click', function() {
                    const targetId = this.getAttribute('data-target');
                    const input = document.getElementById(targetId);
                    const icon = this.querySelector('i');
                    
                    if (input.type === 'password') {
                        input.type = 'text';
                        icon.classList.remove('fa-eye');
                        icon.classList.add('fa-eye-slash');
                    } else {
                        input.type = 'password';
                        icon.classList.remove('fa-eye-slash');
                        icon.classList.add('fa-eye');
                    }
                });
            });

            // Password strength checker
            const strengthBar = document.getElementById('strength-bar');
            const strengthText = document.getElementById('strength-text');
            const strengthIndicator = document.getElementById('password-strength');
            const newPasswordInput = document.getElementById('new-password');

            function checkPasswordStrength(password) {
                let strength = 0;
                const requirements = {
                    length: password.length >= 8,
                    uppercase: /[A-Z]/.test(password),
                    number: /[0-9]/.test(password),
                    special: /[^A-Za-z0-9]/.test(password)
                };

                // Update requirement indicators
                const checks = document.querySelectorAll('.requirement-check');
                checks.forEach((check, index) => {
                    const met = Object.values(requirements)[index];
                    check.style.color = met ? 'var(--accent-green)' : 'var(--text-tertiary)';
                });

                // Calculate strength
                Object.values(requirements).forEach(met => {
                    if (met) strength += 25;
                });

                // Determine color based on strength
                let color;
                let text;
                if (strength <= 25) {
                    color = '#ff4444';
                    text = 'Weak';
                } else if (strength <= 50) {
                    color = '#ffbb33';
                    text = 'Fair';
                } else if (strength <= 75) {
                    color = '#00C851';
                    text = 'Good';
                } else {
                    color = '#007E33';
                    text = 'Strong';
                }

                return { strength, color, text, requirements };
            }

            newPasswordInput.addEventListener('input', function() {
                const result = checkPasswordStrength(this.value);
                strengthIndicator.classList.remove('hidden');
                strengthBar.style.width = result.strength + '%';
                strengthBar.style.backgroundColor = result.color;
                strengthText.textContent = result.text;
            });

            // Password change form submission
            const changePasswordForm = document.getElementById('change-password-form');
            
            changePasswordForm.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const currentPassword = document.getElementById('current-password').value;
                const newPassword = document.getElementById('new-password').value;
                const confirmPassword = document.getElementById('confirm-password').value;

                // Reset any previous error states
                this.querySelectorAll('.form-input').forEach(input => {
                    input.style.borderColor = '';
                });

                // Validate passwords
                if (newPassword !== confirmPassword) {
                    document.getElementById('confirm-password').style.borderColor = 'var(--accent-red)';
                    showNotification('Passwords do not match', 'error');
                    return;
                }

                if (newPassword.length < 8) {
                    document.getElementById('new-password').style.borderColor = 'var(--accent-red)';
                    showNotification('Password must be at least 8 characters long', 'error');
                    return;
                }

                const result = checkPasswordStrength(newPassword);
                if (result.strength < 75) {
                    document.getElementById('new-password').style.borderColor = 'var(--accent-red)';
                    showNotification('Please choose a stronger password', 'error');
                    return;
                }

                // TODO: Replace with actual API call
                try {
                    // Simulated API call
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    // Success
                    showNotification('Password updated successfully', 'success');
                    this.reset();
                    strengthIndicator.classList.add('hidden');
                } catch (error) {
                    showNotification('Failed to update password. Please try again.', 'error');
                }
            });
        });
    </script>
</body>
</html>

